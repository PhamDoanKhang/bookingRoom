"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[797],{797:(n,t,e)=>{e.r(t),e.d(t,{CANCEL:()=>c.n1,END:()=>x,SAGA_LOCATION:()=>c.b_,buffers:()=>u.H,channel:()=>S,default:()=>U,detach:()=>u.I,eventChannel:()=>M,isEnd:()=>R,multicastChannel:()=>A,runSaga:()=>Q,stdChannel:()=>T});var c=e(2470),r=e(7462),a=e(3366),o=e(2847),u=e(5852),i=e(4890);const f=function(){var n={};return n.promise=new Promise((function(t,e){n.resolve=t,n.reject=e})),n};var l=[],s=0;function v(n){try{p(),n()}finally{g()}}function d(n){l.push(n),s||(p(),y())}function h(n){try{return p(),n()}finally{y()}}function p(){s++}function g(){s--}function y(){var n;for(g();!s&&void 0!==(n=l.shift());)v(n)}var k=function(n){return function(t){return n.some((function(n){return j(n)(t)}))}},E=function(n){return function(t){return n(t)}},m=function(n){return function(t){return t.type===String(n)}},b=function(n){return function(t){return t.type===n}},C=function(){return u.k};function j(n){var t="*"===n?C:(0,o.Z_)(n)?m:(0,o.IX)(n)?k:(0,o.eR)(n)?m:(0,o.Yl)(n)?E:(0,o.NA)(n)?b:null;if(null===t)throw new Error("invalid pattern: "+n);return t(n)}var x={type:c.sZ},R=function(n){return n&&n.type===c.sZ};function S(n){void 0===n&&(n=(0,u.e)());var t=!1,e=[];return{take:function(c){t&&n.isEmpty()?c(x):n.isEmpty()?(e.push(c),c.cancel=function(){(0,u.r)(e,c)}):c(n.take())},put:function(c){if(!t){if(0===e.length)return n.put(c);e.shift()(c)}},flush:function(e){t&&n.isEmpty()?e(x):e(n.flush())},close:function(){if(!t){t=!0;var n=e;e=[];for(var c=0,r=n.length;c<r;c++)(0,n[c])(x)}}}}function M(n,t){void 0===t&&(t=(0,u.n)());var e,c=!1,r=S(t),a=function(){c||(c=!0,(0,o.Yl)(e)&&e(),r.close())};return e=n((function(n){R(n)?a():r.put(n)})),e=(0,u.o)(e),c&&e(),{take:r.take,flush:r.flush,close:a}}function A(){var n,t=!1,e=[],r=e,a=function(){r===e&&(r=e.slice())},o=function(){t=!0;var n=e=r;r=[],n.forEach((function(n){n(x)}))};return(n={})[c.AS]=!0,n.put=function(n){if(!t)if(R(n))o();else for(var a=e=r,u=0,i=a.length;u<i;u++){var f=a[u];f[c.uq](n)&&(f.cancel(),f(n))}},n.take=function(n,e){void 0===e&&(e=C),t?n(x):(n[c.uq]=e,a(),r.push(n),n.cancel=(0,u.o)((function(){a(),(0,u.r)(r,n)})))},n.close=o,n}function T(){var n=A(),t=n.put;return n.put=function(n){n[c.Nm]?t(n):d((function(){t(n)}))},n}var I=0,w=1,N=2,O=3;function Z(n,t){var e=n[c.n1];(0,o.Yl)(e)&&(t.cancel=e),n.then(t,(function(n){t(n,!0)}))}var q,D=0,W=function(){return++D};function X(n){n.isRunning()&&n.cancel()}var Y=((q={})[u.T]=function(n,t,e){var r=t.channel,a=void 0===r?n.channel:r,u=t.pattern,i=t.maybe,f=function(n){n instanceof Error?e(n,!0):!R(n)||i?e(n):e(c.EO)};try{a.take(f,(0,o.d5)(u)?j(u):null)}catch(n){return void e(n,!0)}e.cancel=f.cancel},q[u.P]=function(n,t,e){var c=t.channel,r=t.action,a=t.resolve;d((function(){var t;try{t=(c?c.put:n.dispatch)(r)}catch(n){return void e(n,!0)}a&&(0,o.MC)(t)?Z(t,e):e(t)}))},q[u.A]=function(n,t,e,c){var r=c.digestEffect,a=D,i=Object.keys(t);if(0!==i.length){var f=(0,u.l)(t,e);i.forEach((function(n){r(t[n],a,f[n],n)}))}else e((0,o.IX)(t)?[]:{})},q[u.R]=function(n,t,e,c){var r=c.digestEffect,a=D,i=Object.keys(t),f=(0,o.IX)(t)?(0,u.m)(i.length):{},l={},s=!1;i.forEach((function(n){var t=function(t,c){s||(c||(0,u.s)(t)?(e.cancel(),e(t,c)):(e.cancel(),s=!0,f[n]=t,e(f)))};t.cancel=u.t,l[n]=t})),e.cancel=function(){s||(s=!0,i.forEach((function(n){return l[n].cancel()})))},i.forEach((function(n){s||r(t[n],a,l[n],n)}))},q[u.C]=function(n,t,e,c){var r=t.context,a=t.fn,i=t.args,f=c.task;try{var l=a.apply(r,i);if((0,o.MC)(l))return void Z(l,e);if((0,o.hZ)(l))return void K(n,l,f.context,D,(0,u.j)(a),!1,e);e(l)}catch(n){e(n,!0)}},q[u.a]=function(n,t,e){var c=t.context,r=t.fn,a=t.args;try{var u=function(n,t){(0,o.sR)(n)?e(t):e(n,!0)};r.apply(c,a.concat(u)),u.cancel&&(e.cancel=u.cancel)}catch(n){e(n,!0)}},q[u.F]=function(n,t,e,c){var r=t.context,a=t.fn,i=t.args,f=t.detached,l=c.task,s=function(n){var t=n.context,e=n.fn,c=n.args;try{var r=e.apply(t,c);if((0,o.hZ)(r))return r;var a=!1;return(0,u.q)((function(n){return a?{value:n,done:!0}:(a=!0,{value:r,done:!(0,o.MC)(r)})}))}catch(n){return(0,u.q)((function(){throw n}))}}({context:r,fn:a,args:i}),v=function(n,t){return n.isSagaIterator?{name:n.meta.name}:(0,u.j)(t)}(s,a);h((function(){var t=K(n,s,l.context,D,v,f,void 0);f?e(t):t.isRunning()?(l.queue.addTask(t),e(t)):t.isAborted()?l.queue.abort(t.error()):e(t)}))},q[u.J]=function(n,t,e,c){var r=c.task,a=function(n,t){if(n.isRunning()){var e={task:r,cb:t};t.cancel=function(){n.isRunning()&&(0,u.r)(n.joiners,e)},n.joiners.push(e)}else n.isAborted()?t(n.error(),!0):t(n.result())};if((0,o.IX)(t)){if(0===t.length)return void e([]);var i=(0,u.l)(t,e);t.forEach((function(n,t){a(n,i[t])}))}else a(t,e)},q[u.b]=function(n,t,e,r){var a=r.task;t===c.sC?X(a):(0,o.IX)(t)?t.forEach(X):X(t),e()},q[u.S]=function(n,t,e){var c=t.selector,r=t.args;try{e(c.apply(void 0,[n.getState()].concat(r)))}catch(n){e(n,!0)}},q[u.d]=function(n,t,e){var c=t.pattern,r=S(t.buffer),a=j(c),o=function t(e){R(e)||n.channel.take(t,a),r.put(e)},u=r.close;r.close=function(){o.cancel(),u()},n.channel.take(o,a),e(r)},q[u.f]=function(n,t,e,c){e(c.task.isCancelled())},q[u.g]=function(n,t,e){t.flush(e)},q[u.G]=function(n,t,e,c){e(c.task.context[t])},q[u.h]=function(n,t,e,c){var r=c.task;(0,u.p)(r.context,t),e()},q);function z(n,t){return n+"?"+t}function P(n){var t=n.name,e=n.location;return e?t+"  "+z(e.fileName,e.lineNumber):t}function _(n){var t=(0,u.u)((function(n){return n.cancelledTasks}),n);return t.length?["Tasks cancelled due to error:"].concat(t).join("\n"):""}var G=null,L=[],B=function(n){n.crashedEffect=G,L.push(n)},F=function(){G=null,L.length=0},H=function(n){G=n},J=function(){var n,t,e=L[0],c=L.slice(1),r=e.crashedEffect?(n=e.crashedEffect,(t=(0,u.v)(n))?t.code+"  "+z(t.fileName,t.lineNumber):""):null;return["The above error occurred in task "+P(e.meta)+(r?" \n when executing effect "+r:"")].concat(c.map((function(n){return"    created by "+P(n.meta)})),[_(L)]).join("\n")};function K(n,t,e,r,a,i,l){var s=n.finalizeRunEffect((function(t,e,r){(0,o.MC)(t)?Z(t,r):(0,o.hZ)(t)?K(n,t,d.context,e,a,!1,r):t&&t[c.IO]?(0,Y[t.type])(n,t.payload,r,h):r(t)}));p.cancel=u.t;var v={meta:a,cancel:function(){v.status===I&&(v.status=w,p(c.Wd))},status:I},d=function(n,t,e,r,a,o,i){var l;void 0===i&&(i=u.t);var s,v,d=I,h=null,p=[],g=Object.create(e),y=function(n,t,e){var c,r=[],a=!1;function o(n){t(),f(),e(n,!0)}function i(t){r.push(t),t.cont=function(i,f){a||((0,u.r)(r,t),t.cont=u.t,f?o(i):(t===n&&(c=i),r.length||(a=!0,e(c))))}}function f(){a||(a=!0,r.forEach((function(n){n.cont=u.t,n.cancel()})),r=[])}return i(n),{addTask:i,cancelAll:f,abort:o,getTasks:function(){return r}}}(t,(function(){p.push.apply(p,y.getTasks().map((function(n){return n.meta.name})))}),k);function k(t,e){if(e){if(d=N,B({meta:a,cancelledTasks:p}),E.isRoot){var r=J();F(),n.onError(t,{sagaStack:r})}v=t,h&&h.reject(t)}else t===c.Wd?d=w:d!==w&&(d=O),s=t,h&&h.resolve(t);E.cont(t,e),E.joiners.forEach((function(n){n.cb(t,e)})),E.joiners=null}var E=((l={})[c.Cs]=!0,l.id=r,l.meta=a,l.isRoot=o,l.context=g,l.joiners=[],l.queue=y,l.cancel=function(){d===I&&(d=w,y.cancelAll(),k(c.Wd,!1))},l.cont=i,l.end=k,l.setContext=function(n){(0,u.p)(g,n)},l.toPromise=function(){return h||(h=f(),d===N?h.reject(v):d!==I&&h.resolve(s)),h.promise},l.isRunning=function(){return d===I},l.isCancelled=function(){return d===w||d===I&&t.status===w},l.isAborted=function(){return d===N},l.result=function(){return s},l.error=function(){return v},l);return E}(n,v,e,r,a,i,l),h={task:d,digestEffect:g};return l&&(l.cancel=d.cancel),p(),d;function p(n,e){try{var a;e?(a=t.throw(n),F()):(0,u.y)(n)?(v.status=w,p.cancel(),a=(0,o.Yl)(t.return)?t.return(c.Wd):{done:!0,value:c.Wd}):a=(0,u.z)(n)?(0,o.Yl)(t.return)?t.return():{done:!0}:t.next(n),a.done?(v.status!==w&&(v.status=O),v.cont(a.value)):g(a.value,r,p)}catch(n){if(v.status===w)throw n;v.status=N,v.cont(n,!0)}}function g(t,e,c,r){void 0===r&&(r="");var a,o=W();function i(e,r){a||(a=!0,c.cancel=u.t,n.sagaMonitor&&(r?n.sagaMonitor.effectRejected(o,e):n.sagaMonitor.effectResolved(o,e)),r&&H(t),c(e,r))}n.sagaMonitor&&n.sagaMonitor.effectTriggered({effectId:o,parentEffectId:e,label:r,effect:t}),i.cancel=u.t,c.cancel=function(){a||(a=!0,i.cancel(),i.cancel=u.t,n.sagaMonitor&&n.sagaMonitor.effectCancelled(o))},s(t,o,i)}}function Q(n,t){for(var e=n.channel,c=void 0===e?T():e,r=n.dispatch,a=n.getState,o=n.context,f=void 0===o?{}:o,l=n.sagaMonitor,s=n.effectMiddlewares,v=n.onError,d=void 0===v?u.B:v,p=arguments.length,g=new Array(p>2?p-2:0),y=2;y<p;y++)g[y-2]=arguments[y];var k,E=t.apply(void 0,g),m=W();if(l&&(l.rootSagaStarted=l.rootSagaStarted||u.t,l.effectTriggered=l.effectTriggered||u.t,l.effectResolved=l.effectResolved||u.t,l.effectRejected=l.effectRejected||u.t,l.effectCancelled=l.effectCancelled||u.t,l.actionDispatched=l.actionDispatched||u.t,l.rootSagaStarted({effectId:m,saga:t,args:g})),s){var b=i.qC.apply(void 0,s);k=function(n){return function(t,e,c){return b((function(t){return n(t,e,c)}))(t)}}}else k=u.E;var C={channel:c,dispatch:(0,u.D)(r),getState:a,sagaMonitor:l,onError:d,finalizeRunEffect:k};return h((function(){var n=K(C,E,f,m,(0,u.j)(t),!0,void 0);return l&&l.effectResolved(m,n),n}))}const U=function(n){var t,e=void 0===n?{}:n,c=e.context,o=void 0===c?{}:c,i=e.channel,f=void 0===i?T():i,l=e.sagaMonitor,s=(0,a.Z)(e,["context","channel","sagaMonitor"]);function v(n){var e=n.getState,c=n.dispatch;return t=Q.bind(null,(0,r.Z)({},s,{context:o,channel:f,dispatch:c,getState:e,sagaMonitor:l})),function(n){return function(t){l&&l.actionDispatched&&l.actionDispatched(t);var e=n(t);return f.put(t),e}}}return v.run=function(){return t.apply(void 0,arguments)},v.setContext=function(n){(0,u.p)(o,n)},v}},3366:(n,t,e)=>{function c(n,t){if(null==n)return{};var e,c,r={},a=Object.keys(n);for(c=0;c<a.length;c++)e=a[c],t.indexOf(e)>=0||(r[e]=n[e]);return r}e.d(t,{Z:()=>c})}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RVIsU0FBVXhCLEdBQ2YsT0FBTyxTQUFVNUcsR0FDWG9JLEdBQWVBLEVBQVlnQixrQkFDN0JoQixFQUFZZ0IsaUJBQWlCcEosR0FHL0IsSUFBSUMsRUFBUzJHLEVBQUs1RyxHQUdsQixPQURBeEQsRUFBUVUsSUFBSThDLEdBQ0xDLENBQ1QsQ0FDRixDQUNGLENBa0JBLE9BaEJBMEosRUFBZUUsSUFBTSxXQUtuQixPQUFPSixFQUFhOUgsV0FBTSxFQUFRcUgsVUFDcEMsRUFFQVcsRUFBZTlCLFdBQWEsU0FBVXBELElBS3BDLE9BQWtCakQsRUFBU2lELEVBQzdCLEVBRU9rRixDQUNULEMsaUJFMTVDZSxTQUFTRyxFQUE4QkMsRUFBUUMsR0FDNUQsR0FBYyxNQUFWRCxFQUFnQixNQUFPLENBQUMsRUFDNUIsSUFFSXBKLEVBQUtyRCxFQUZMMk0sRUFBUyxDQUFDLEVBQ1ZDLEVBQWF6SixPQUFPRCxLQUFLdUosR0FFN0IsSUFBS3pNLEVBQUksRUFBR0EsRUFBSTRNLEVBQVcvTSxPQUFRRyxJQUNqQ3FELEVBQU11SixFQUFXNU0sR0FDYjBNLEVBQVNHLFFBQVF4SixJQUFRLElBQzdCc0osRUFBT3RKLEdBQU9vSixFQUFPcEosSUFFdkIsT0FBT3NKLENBQ1QsQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NsaWVudC8uL25vZGVfbW9kdWxlcy9AcmVkdXgtc2FnYS9kZWZlcnJlZC9kaXN0L3JlZHV4LXNhZ2EtZGVmZXJyZWQuZXNtLmpzIiwid2VicGFjazovL2NsaWVudC8uL25vZGVfbW9kdWxlcy9AcmVkdXgtc2FnYS9jb3JlL2Rpc3QvcmVkdXgtc2FnYS1jb3JlLmVzbS5qcyIsIndlYnBhY2s6Ly9jbGllbnQvLi9ub2RlX21vZHVsZXMvcmVkdXgtc2FnYS9kaXN0L3JlZHV4LXNhZ2EtY29yZS1ucG0tcHJveHkuZXNtLmpzIiwid2VicGFjazovL2NsaWVudC8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGRlZmVycmVkKCkge1xuICB2YXIgZGVmID0ge307XG4gIGRlZi5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGRlZi5yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICBkZWYucmVqZWN0ID0gcmVqZWN0O1xuICB9KTtcbiAgcmV0dXJuIGRlZjtcbn1cbmZ1bmN0aW9uIGFycmF5T2ZEZWZlcnJlZChsZW5ndGgpIHtcbiAgdmFyIGFyciA9IFtdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBhcnIucHVzaChkZWZlcnJlZCgpKTtcbiAgfVxuXG4gIHJldHVybiBhcnI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGRlZmVycmVkO1xuZXhwb3J0IHsgYXJyYXlPZkRlZmVycmVkIH07XG4iLCJpbXBvcnQgeyBDSEFOTkVMX0VORF9UWVBFLCBNVUxUSUNBU1QsIE1BVENILCBTQUdBX0FDVElPTiwgQ0FOQ0VMLCBTRUxGX0NBTkNFTExBVElPTiwgVEVSTUlOQVRFLCBUQVNLLCBUQVNLX0NBTkNFTCwgSU8gfSBmcm9tICdAcmVkdXgtc2FnYS9zeW1ib2xzJztcbmV4cG9ydCB7IENBTkNFTCwgU0FHQV9MT0NBVElPTiB9IGZyb20gJ0ByZWR1eC1zYWdhL3N5bWJvbHMnO1xuaW1wb3J0IF9leHRlbmRzIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHMnO1xuaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UnO1xuaW1wb3J0IHsgc3RyaW5nIGFzIHN0cmluZyQxLCBhcnJheSBhcyBhcnJheSQxLCBzdHJpbmdhYmxlRnVuYywgZnVuYywgc3ltYm9sIGFzIHN5bWJvbCQxLCBidWZmZXIsIG5vdFVuZGVmLCBwcm9taXNlLCBpdGVyYXRvciwgdW5kZWYsIG9iamVjdCwgY2hhbm5lbCBhcyBjaGFubmVsJDEgfSBmcm9tICdAcmVkdXgtc2FnYS9pcyc7XG5pbXBvcnQgeyBrIGFzIGtUcnVlLCBlIGFzIGV4cGFuZGluZywgYyBhcyBjaGVjaywgbyBhcyBvbmNlLCByIGFzIHJlbW92ZSwgbiBhcyBub25lLCBpIGFzIGludGVybmFsRXJyLCBUIGFzIFRBS0UsIFAgYXMgUFVULCBBIGFzIEFMTCwgUiBhcyBSQUNFLCBDIGFzIENBTEwsIGEgYXMgQ1BTLCBGIGFzIEZPUkssIEogYXMgSk9JTiwgYiBhcyBDQU5DRUwkMSwgUyBhcyBTRUxFQ1QsIGQgYXMgQUNUSU9OX0NIQU5ORUwsIGYgYXMgQ0FOQ0VMTEVEJDEsIGcgYXMgRkxVU0gsIEcgYXMgR0VUX0NPTlRFWFQsIGggYXMgU0VUX0NPTlRFWFQsIGogYXMgZ2V0TWV0YUluZm8sIGwgYXMgY3JlYXRlQWxsU3R5bGVDaGlsZENhbGxiYWNrcywgbSBhcyBjcmVhdGVFbXB0eUFycmF5LCBwIGFzIGFzc2lnbldpdGhTeW1ib2xzLCBxIGFzIG1ha2VJdGVyYXRvciwgcyBhcyBzaG91bGRDb21wbGV0ZSwgdCBhcyBub29wLCB1IGFzIGZsYXRNYXAsIHYgYXMgZ2V0TG9jYXRpb24sIHcgYXMgY3JlYXRlU2V0Q29udGV4dFdhcm5pbmcsIHggYXMgYXN5bmNJdGVyYXRvclN5bWJvbCwgeSBhcyBzaG91bGRDYW5jZWwsIHogYXMgc2hvdWxkVGVybWluYXRlLCBCIGFzIGxvZ0Vycm9yLCBEIGFzIHdyYXBTYWdhRGlzcGF0Y2gsIEUgYXMgaWRlbnRpdHkgfSBmcm9tICcuL2lvLWMzNzkyOTYzLmpzJztcbmV4cG9ydCB7IEggYXMgYnVmZmVycywgSSBhcyBkZXRhY2ggfSBmcm9tICcuL2lvLWMzNzkyOTYzLmpzJztcbmltcG9ydCB7IGNvbXBvc2UgfSBmcm9tICdyZWR1eCc7XG5pbXBvcnQgZGVmZXJyZWQgZnJvbSAnQHJlZHV4LXNhZ2EvZGVmZXJyZWQnO1xuaW1wb3J0ICdAcmVkdXgtc2FnYS9kZWxheS1wJztcblxudmFyIHF1ZXVlID0gW107XG4vKipcbiAgVmFyaWFibGUgdG8gaG9sZCBhIGNvdW50aW5nIHNlbWFwaG9yZVxuICAtIEluY3JlbWVudGluZyBhZGRzIGEgbG9jayBhbmQgcHV0cyB0aGUgc2NoZWR1bGVyIGluIGEgYHN1c3BlbmRlZGAgc3RhdGUgKGlmIGl0J3Mgbm90XG4gICAgYWxyZWFkeSBzdXNwZW5kZWQpXG4gIC0gRGVjcmVtZW50aW5nIHJlbGVhc2VzIGEgbG9jay4gWmVybyBsb2NrcyBwdXRzIHRoZSBzY2hlZHVsZXIgaW4gYSBgcmVsZWFzZWRgIHN0YXRlLiBUaGlzXG4gICAgdHJpZ2dlcnMgZmx1c2hpbmcgdGhlIHF1ZXVlZCB0YXNrcy5cbioqL1xuXG52YXIgc2VtYXBob3JlID0gMDtcbi8qKlxuICBFeGVjdXRlcyBhIHRhc2sgJ2F0b21pY2FsbHknLiBUYXNrcyBzY2hlZHVsZWQgZHVyaW5nIHRoaXMgZXhlY3V0aW9uIHdpbGwgYmUgcXVldWVkXG4gIGFuZCBmbHVzaGVkIGFmdGVyIHRoaXMgdGFzayBoYXMgZmluaXNoZWQgKGFzc3VtaW5nIHRoZSBzY2hlZHVsZXIgZW5kdXAgaW4gYSByZWxlYXNlZFxuICBzdGF0ZSkuXG4qKi9cblxuZnVuY3Rpb24gZXhlYyh0YXNrKSB7XG4gIHRyeSB7XG4gICAgc3VzcGVuZCgpO1xuICAgIHRhc2soKTtcbiAgfSBmaW5hbGx5IHtcbiAgICByZWxlYXNlKCk7XG4gIH1cbn1cbi8qKlxuICBFeGVjdXRlcyBvciBxdWV1ZXMgYSB0YXNrIGRlcGVuZGluZyBvbiB0aGUgc3RhdGUgb2YgdGhlIHNjaGVkdWxlciAoYHN1c3BlbmRlZGAgb3IgYHJlbGVhc2VkYClcbioqL1xuXG5cbmZ1bmN0aW9uIGFzYXAodGFzaykge1xuICBxdWV1ZS5wdXNoKHRhc2spO1xuXG4gIGlmICghc2VtYXBob3JlKSB7XG4gICAgc3VzcGVuZCgpO1xuICAgIGZsdXNoKCk7XG4gIH1cbn1cbi8qKlxuICogUHV0cyB0aGUgc2NoZWR1bGVyIGluIGEgYHN1c3BlbmRlZGAgc3RhdGUgYW5kIGV4ZWN1dGVzIGEgdGFzayBpbW1lZGlhdGVseS5cbiAqL1xuXG5mdW5jdGlvbiBpbW1lZGlhdGVseSh0YXNrKSB7XG4gIHRyeSB7XG4gICAgc3VzcGVuZCgpO1xuICAgIHJldHVybiB0YXNrKCk7XG4gIH0gZmluYWxseSB7XG4gICAgZmx1c2goKTtcbiAgfVxufVxuLyoqXG4gIFB1dHMgdGhlIHNjaGVkdWxlciBpbiBhIGBzdXNwZW5kZWRgIHN0YXRlLiBTY2hlZHVsZWQgdGFza3Mgd2lsbCBiZSBxdWV1ZWQgdW50aWwgdGhlXG4gIHNjaGVkdWxlciBpcyByZWxlYXNlZC5cbioqL1xuXG5mdW5jdGlvbiBzdXNwZW5kKCkge1xuICBzZW1hcGhvcmUrKztcbn1cbi8qKlxuICBQdXRzIHRoZSBzY2hlZHVsZXIgaW4gYSBgcmVsZWFzZWRgIHN0YXRlLlxuKiovXG5cblxuZnVuY3Rpb24gcmVsZWFzZSgpIHtcbiAgc2VtYXBob3JlLS07XG59XG4vKipcbiAgUmVsZWFzZXMgdGhlIGN1cnJlbnQgbG9jay4gRXhlY3V0ZXMgYWxsIHF1ZXVlZCB0YXNrcyBpZiB0aGUgc2NoZWR1bGVyIGlzIGluIHRoZSByZWxlYXNlZCBzdGF0ZS5cbioqL1xuXG5cbmZ1bmN0aW9uIGZsdXNoKCkge1xuICByZWxlYXNlKCk7XG4gIHZhciB0YXNrO1xuXG4gIHdoaWxlICghc2VtYXBob3JlICYmICh0YXNrID0gcXVldWUuc2hpZnQoKSkgIT09IHVuZGVmaW5lZCkge1xuICAgIGV4ZWModGFzayk7XG4gIH1cbn1cblxudmFyIGFycmF5ID0gZnVuY3Rpb24gYXJyYXkocGF0dGVybnMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIHJldHVybiBwYXR0ZXJucy5zb21lKGZ1bmN0aW9uIChwKSB7XG4gICAgICByZXR1cm4gbWF0Y2hlcihwKShpbnB1dCk7XG4gICAgfSk7XG4gIH07XG59O1xudmFyIHByZWRpY2F0ZSA9IGZ1bmN0aW9uIHByZWRpY2F0ZShfcHJlZGljYXRlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICByZXR1cm4gX3ByZWRpY2F0ZShpbnB1dCk7XG4gIH07XG59O1xudmFyIHN0cmluZyA9IGZ1bmN0aW9uIHN0cmluZyhwYXR0ZXJuKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICByZXR1cm4gaW5wdXQudHlwZSA9PT0gU3RyaW5nKHBhdHRlcm4pO1xuICB9O1xufTtcbnZhciBzeW1ib2wgPSBmdW5jdGlvbiBzeW1ib2wocGF0dGVybikge1xuICByZXR1cm4gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgcmV0dXJuIGlucHV0LnR5cGUgPT09IHBhdHRlcm47XG4gIH07XG59O1xudmFyIHdpbGRjYXJkID0gZnVuY3Rpb24gd2lsZGNhcmQoKSB7XG4gIHJldHVybiBrVHJ1ZTtcbn07XG5mdW5jdGlvbiBtYXRjaGVyKHBhdHRlcm4pIHtcbiAgLy8gcHJldHRpZXItaWdub3JlXG4gIHZhciBtYXRjaGVyQ3JlYXRvciA9IHBhdHRlcm4gPT09ICcqJyA/IHdpbGRjYXJkIDogc3RyaW5nJDEocGF0dGVybikgPyBzdHJpbmcgOiBhcnJheSQxKHBhdHRlcm4pID8gYXJyYXkgOiBzdHJpbmdhYmxlRnVuYyhwYXR0ZXJuKSA/IHN0cmluZyA6IGZ1bmMocGF0dGVybikgPyBwcmVkaWNhdGUgOiBzeW1ib2wkMShwYXR0ZXJuKSA/IHN5bWJvbCA6IG51bGw7XG5cbiAgaWYgKG1hdGNoZXJDcmVhdG9yID09PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBwYXR0ZXJuOiBcIiArIHBhdHRlcm4pO1xuICB9XG5cbiAgcmV0dXJuIG1hdGNoZXJDcmVhdG9yKHBhdHRlcm4pO1xufVxuXG52YXIgRU5EID0ge1xuICB0eXBlOiBDSEFOTkVMX0VORF9UWVBFXG59O1xudmFyIGlzRW5kID0gZnVuY3Rpb24gaXNFbmQoYSkge1xuICByZXR1cm4gYSAmJiBhLnR5cGUgPT09IENIQU5ORUxfRU5EX1RZUEU7XG59O1xudmFyIENMT1NFRF9DSEFOTkVMX1dJVEhfVEFLRVJTID0gJ0Nhbm5vdCBoYXZlIGEgY2xvc2VkIGNoYW5uZWwgd2l0aCBwZW5kaW5nIHRha2Vycyc7XG52YXIgSU5WQUxJRF9CVUZGRVIgPSAnaW52YWxpZCBidWZmZXIgcGFzc2VkIHRvIGNoYW5uZWwgZmFjdG9yeSBmdW5jdGlvbic7XG52YXIgVU5ERUZJTkVEX0lOUFVUX0VSUk9SID0gXCJTYWdhIG9yIGNoYW5uZWwgd2FzIHByb3ZpZGVkIHdpdGggYW4gdW5kZWZpbmVkIGFjdGlvblxcbkhpbnRzOlxcbiAgLSBjaGVjayB0aGF0IHlvdXIgQWN0aW9uIENyZWF0b3IgcmV0dXJucyBhIG5vbi11bmRlZmluZWQgdmFsdWVcXG4gIC0gaWYgdGhlIFNhZ2Egd2FzIHN0YXJ0ZWQgdXNpbmcgcnVuU2FnYSwgY2hlY2sgdGhhdCB5b3VyIHN1YnNjcmliZSBzb3VyY2UgcHJvdmlkZXMgdGhlIGFjdGlvbiB0byBpdHMgbGlzdGVuZXJzXCI7XG5mdW5jdGlvbiBjaGFubmVsKGJ1ZmZlciQxKSB7XG4gIGlmIChidWZmZXIkMSA9PT0gdm9pZCAwKSB7XG4gICAgYnVmZmVyJDEgPSBleHBhbmRpbmcoKTtcbiAgfVxuXG4gIHZhciBjbG9zZWQgPSBmYWxzZTtcbiAgdmFyIHRha2VycyA9IFtdO1xuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgY2hlY2soYnVmZmVyJDEsIGJ1ZmZlciwgSU5WQUxJRF9CVUZGRVIpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tGb3JiaWRkZW5TdGF0ZXMoKSB7XG4gICAgaWYgKGNsb3NlZCAmJiB0YWtlcnMubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBpbnRlcm5hbEVycihDTE9TRURfQ0hBTk5FTF9XSVRIX1RBS0VSUyk7XG4gICAgfVxuXG4gICAgaWYgKHRha2Vycy5sZW5ndGggJiYgIWJ1ZmZlciQxLmlzRW1wdHkoKSkge1xuICAgICAgdGhyb3cgaW50ZXJuYWxFcnIoJ0Nhbm5vdCBoYXZlIHBlbmRpbmcgdGFrZXJzIHdpdGggbm9uIGVtcHR5IGJ1ZmZlcicpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHB1dChpbnB1dCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjaGVja0ZvcmJpZGRlblN0YXRlcygpO1xuICAgICAgY2hlY2soaW5wdXQsIG5vdFVuZGVmLCBVTkRFRklORURfSU5QVVRfRVJST1IpO1xuICAgIH1cblxuICAgIGlmIChjbG9zZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGFrZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGJ1ZmZlciQxLnB1dChpbnB1dCk7XG4gICAgfVxuXG4gICAgdmFyIGNiID0gdGFrZXJzLnNoaWZ0KCk7XG4gICAgY2IoaW5wdXQpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGFrZShjYikge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjaGVja0ZvcmJpZGRlblN0YXRlcygpO1xuICAgICAgY2hlY2soY2IsIGZ1bmMsIFwiY2hhbm5lbC50YWtlJ3MgY2FsbGJhY2sgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cblxuICAgIGlmIChjbG9zZWQgJiYgYnVmZmVyJDEuaXNFbXB0eSgpKSB7XG4gICAgICBjYihFTkQpO1xuICAgIH0gZWxzZSBpZiAoIWJ1ZmZlciQxLmlzRW1wdHkoKSkge1xuICAgICAgY2IoYnVmZmVyJDEudGFrZSgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFrZXJzLnB1c2goY2IpO1xuXG4gICAgICBjYi5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlbW92ZSh0YWtlcnMsIGNiKTtcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZmx1c2goY2IpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY2hlY2tGb3JiaWRkZW5TdGF0ZXMoKTtcbiAgICAgIGNoZWNrKGNiLCBmdW5jLCBcImNoYW5uZWwuZmx1c2gnIGNhbGxiYWNrIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG5cbiAgICBpZiAoY2xvc2VkICYmIGJ1ZmZlciQxLmlzRW1wdHkoKSkge1xuICAgICAgY2IoRU5EKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYihidWZmZXIkMS5mbHVzaCgpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjaGVja0ZvcmJpZGRlblN0YXRlcygpO1xuICAgIH1cblxuICAgIGlmIChjbG9zZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjbG9zZWQgPSB0cnVlO1xuICAgIHZhciBhcnIgPSB0YWtlcnM7XG4gICAgdGFrZXJzID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICB2YXIgdGFrZXIgPSBhcnJbaV07XG4gICAgICB0YWtlcihFTkQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdGFrZTogdGFrZSxcbiAgICBwdXQ6IHB1dCxcbiAgICBmbHVzaDogZmx1c2gsXG4gICAgY2xvc2U6IGNsb3NlXG4gIH07XG59XG5mdW5jdGlvbiBldmVudENoYW5uZWwoc3Vic2NyaWJlLCBidWZmZXIpIHtcbiAgaWYgKGJ1ZmZlciA9PT0gdm9pZCAwKSB7XG4gICAgYnVmZmVyID0gbm9uZSgpO1xuICB9XG5cbiAgdmFyIGNsb3NlZCA9IGZhbHNlO1xuICB2YXIgdW5zdWJzY3JpYmU7XG4gIHZhciBjaGFuID0gY2hhbm5lbChidWZmZXIpO1xuXG4gIHZhciBjbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIGlmIChjbG9zZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjbG9zZWQgPSB0cnVlO1xuXG4gICAgaWYgKGZ1bmModW5zdWJzY3JpYmUpKSB7XG4gICAgICB1bnN1YnNjcmliZSgpO1xuICAgIH1cblxuICAgIGNoYW4uY2xvc2UoKTtcbiAgfTtcblxuICB1bnN1YnNjcmliZSA9IHN1YnNjcmliZShmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICBpZiAoaXNFbmQoaW5wdXQpKSB7XG4gICAgICBjbG9zZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNoYW4ucHV0KGlucHV0KTtcbiAgfSk7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBjaGVjayh1bnN1YnNjcmliZSwgZnVuYywgJ2luIGV2ZW50Q2hhbm5lbDogc3Vic2NyaWJlIHNob3VsZCByZXR1cm4gYSBmdW5jdGlvbiB0byB1bnN1YnNjcmliZScpO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUgPSBvbmNlKHVuc3Vic2NyaWJlKTtcblxuICBpZiAoY2xvc2VkKSB7XG4gICAgdW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdGFrZTogY2hhbi50YWtlLFxuICAgIGZsdXNoOiBjaGFuLmZsdXNoLFxuICAgIGNsb3NlOiBjbG9zZVxuICB9O1xufVxuZnVuY3Rpb24gbXVsdGljYXN0Q2hhbm5lbCgpIHtcbiAgdmFyIF9yZWY7XG5cbiAgdmFyIGNsb3NlZCA9IGZhbHNlO1xuICB2YXIgY3VycmVudFRha2VycyA9IFtdO1xuICB2YXIgbmV4dFRha2VycyA9IGN1cnJlbnRUYWtlcnM7XG5cbiAgZnVuY3Rpb24gY2hlY2tGb3JiaWRkZW5TdGF0ZXMoKSB7XG4gICAgaWYgKGNsb3NlZCAmJiBuZXh0VGFrZXJzLmxlbmd0aCkge1xuICAgICAgdGhyb3cgaW50ZXJuYWxFcnIoQ0xPU0VEX0NIQU5ORUxfV0lUSF9UQUtFUlMpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBlbnN1cmVDYW5NdXRhdGVOZXh0VGFrZXJzID0gZnVuY3Rpb24gZW5zdXJlQ2FuTXV0YXRlTmV4dFRha2VycygpIHtcbiAgICBpZiAobmV4dFRha2VycyAhPT0gY3VycmVudFRha2Vycykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIG5leHRUYWtlcnMgPSBjdXJyZW50VGFrZXJzLnNsaWNlKCk7XG4gIH07XG5cbiAgdmFyIGNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNoZWNrRm9yYmlkZGVuU3RhdGVzKCk7XG4gICAgfVxuXG4gICAgY2xvc2VkID0gdHJ1ZTtcbiAgICB2YXIgdGFrZXJzID0gY3VycmVudFRha2VycyA9IG5leHRUYWtlcnM7XG4gICAgbmV4dFRha2VycyA9IFtdO1xuICAgIHRha2Vycy5mb3JFYWNoKGZ1bmN0aW9uICh0YWtlcikge1xuICAgICAgdGFrZXIoRU5EKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gX3JlZiA9IHt9LCBfcmVmW01VTFRJQ0FTVF0gPSB0cnVlLCBfcmVmLnB1dCA9IGZ1bmN0aW9uIHB1dChpbnB1dCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBjaGVja0ZvcmJpZGRlblN0YXRlcygpO1xuICAgICAgY2hlY2soaW5wdXQsIG5vdFVuZGVmLCBVTkRFRklORURfSU5QVVRfRVJST1IpO1xuICAgIH1cblxuICAgIGlmIChjbG9zZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXNFbmQoaW5wdXQpKSB7XG4gICAgICBjbG9zZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB0YWtlcnMgPSBjdXJyZW50VGFrZXJzID0gbmV4dFRha2VycztcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0YWtlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHZhciB0YWtlciA9IHRha2Vyc1tpXTtcblxuICAgICAgaWYgKHRha2VyW01BVENIXShpbnB1dCkpIHtcbiAgICAgICAgdGFrZXIuY2FuY2VsKCk7XG4gICAgICAgIHRha2VyKGlucHV0KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIF9yZWYudGFrZSA9IGZ1bmN0aW9uIHRha2UoY2IsIG1hdGNoZXIpIHtcbiAgICBpZiAobWF0Y2hlciA9PT0gdm9pZCAwKSB7XG4gICAgICBtYXRjaGVyID0gd2lsZGNhcmQ7XG4gICAgfVxuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNoZWNrRm9yYmlkZGVuU3RhdGVzKCk7XG4gICAgfVxuXG4gICAgaWYgKGNsb3NlZCkge1xuICAgICAgY2IoRU5EKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYltNQVRDSF0gPSBtYXRjaGVyO1xuICAgIGVuc3VyZUNhbk11dGF0ZU5leHRUYWtlcnMoKTtcbiAgICBuZXh0VGFrZXJzLnB1c2goY2IpO1xuICAgIGNiLmNhbmNlbCA9IG9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgZW5zdXJlQ2FuTXV0YXRlTmV4dFRha2VycygpO1xuICAgICAgcmVtb3ZlKG5leHRUYWtlcnMsIGNiKTtcbiAgICB9KTtcbiAgfSwgX3JlZi5jbG9zZSA9IGNsb3NlLCBfcmVmO1xufVxuZnVuY3Rpb24gc3RkQ2hhbm5lbCgpIHtcbiAgdmFyIGNoYW4gPSBtdWx0aWNhc3RDaGFubmVsKCk7XG4gIHZhciBwdXQgPSBjaGFuLnB1dDtcblxuICBjaGFuLnB1dCA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIGlmIChpbnB1dFtTQUdBX0FDVElPTl0pIHtcbiAgICAgIHB1dChpbnB1dCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXNhcChmdW5jdGlvbiAoKSB7XG4gICAgICBwdXQoaW5wdXQpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBjaGFuO1xufVxuXG52YXIgUlVOTklORyA9IDA7XG52YXIgQ0FOQ0VMTEVEID0gMTtcbnZhciBBQk9SVEVEID0gMjtcbnZhciBET05FID0gMztcblxuZnVuY3Rpb24gcmVzb2x2ZVByb21pc2UocHJvbWlzZSwgY2IpIHtcbiAgdmFyIGNhbmNlbFByb21pc2UgPSBwcm9taXNlW0NBTkNFTF07XG5cbiAgaWYgKGZ1bmMoY2FuY2VsUHJvbWlzZSkpIHtcbiAgICBjYi5jYW5jZWwgPSBjYW5jZWxQcm9taXNlO1xuICB9XG5cbiAgcHJvbWlzZS50aGVuKGNiLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBjYihlcnJvciwgdHJ1ZSk7XG4gIH0pO1xufVxuXG52YXIgY3VycmVudCA9IDA7XG52YXIgbmV4dFNhZ2FJZCA9IChmdW5jdGlvbiAoKSB7XG4gIHJldHVybiArK2N1cnJlbnQ7XG59KTtcblxudmFyIF9lZmZlY3RSdW5uZXJNYXA7XG5cbmZ1bmN0aW9uIGdldEl0ZXJhdG9yTWV0YUluZm8oaXRlcmF0b3IsIGZuKSB7XG4gIGlmIChpdGVyYXRvci5pc1NhZ2FJdGVyYXRvcikge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBpdGVyYXRvci5tZXRhLm5hbWVcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIGdldE1ldGFJbmZvKGZuKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVGFza0l0ZXJhdG9yKF9yZWYpIHtcbiAgdmFyIGNvbnRleHQgPSBfcmVmLmNvbnRleHQsXG4gICAgICBmbiA9IF9yZWYuZm4sXG4gICAgICBhcmdzID0gX3JlZi5hcmdzO1xuXG4gIC8vIGNhdGNoIHN5bmNocm9ub3VzIGZhaWx1cmVzOyBzZWUgIzE1MiBhbmQgIzQ0MVxuICB0cnkge1xuICAgIHZhciByZXN1bHQgPSBmbi5hcHBseShjb250ZXh0LCBhcmdzKTsgLy8gaS5lLiBhIGdlbmVyYXRvciBmdW5jdGlvbiByZXR1cm5zIGFuIGl0ZXJhdG9yXG5cbiAgICBpZiAoaXRlcmF0b3IocmVzdWx0KSkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICB2YXIgcmVzb2x2ZWQgPSBmYWxzZTtcblxuICAgIHZhciBuZXh0ID0gZnVuY3Rpb24gbmV4dChhcmcpIHtcbiAgICAgIGlmICghcmVzb2x2ZWQpIHtcbiAgICAgICAgcmVzb2x2ZWQgPSB0cnVlOyAvLyBPbmx5IHByb21pc2VzIHJldHVybmVkIGZyb20gZm9yayB3aWxsIGJlIGludGVycHJldGVkLiBTZWUgIzE1NzNcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbHVlOiByZXN1bHQsXG4gICAgICAgICAgZG9uZTogIXByb21pc2UocmVzdWx0KVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWx1ZTogYXJnLFxuICAgICAgICAgIGRvbmU6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIG1ha2VJdGVyYXRvcihuZXh0KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gZG8gbm90IGJ1YmJsZSB1cCBzeW5jaHJvbm91cyBmYWlsdXJlcyBmb3IgZGV0YWNoZWQgZm9ya3NcbiAgICAvLyBpbnN0ZWFkIGNyZWF0ZSBhIGZhaWxlZCB0YXNrLiBTZWUgIzE1MiBhbmQgIzQ0MVxuICAgIHJldHVybiBtYWtlSXRlcmF0b3IoZnVuY3Rpb24gKCkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJ1blB1dEVmZmVjdChlbnYsIF9yZWYyLCBjYikge1xuICB2YXIgY2hhbm5lbCA9IF9yZWYyLmNoYW5uZWwsXG4gICAgICBhY3Rpb24gPSBfcmVmMi5hY3Rpb24sXG4gICAgICByZXNvbHZlID0gX3JlZjIucmVzb2x2ZTtcblxuICAvKipcbiAgIFNjaGVkdWxlIHRoZSBwdXQgaW4gY2FzZSBhbm90aGVyIHNhZ2EgaXMgaG9sZGluZyBhIGxvY2suXG4gICBUaGUgcHV0IHdpbGwgYmUgZXhlY3V0ZWQgYXRvbWljYWxseS4gaWUgbmVzdGVkIHB1dHMgd2lsbCBleGVjdXRlIGFmdGVyXG4gICB0aGlzIHB1dCBoYXMgdGVybWluYXRlZC5cbiAgICoqL1xuICBhc2FwKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcmVzdWx0O1xuXG4gICAgdHJ5IHtcbiAgICAgIHJlc3VsdCA9IChjaGFubmVsID8gY2hhbm5lbC5wdXQgOiBlbnYuZGlzcGF0Y2gpKGFjdGlvbik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNiKGVycm9yLCB0cnVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocmVzb2x2ZSAmJiBwcm9taXNlKHJlc3VsdCkpIHtcbiAgICAgIHJlc29sdmVQcm9taXNlKHJlc3VsdCwgY2IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYihyZXN1bHQpO1xuICAgIH1cbiAgfSk7IC8vIFB1dCBlZmZlY3RzIGFyZSBub24gY2FuY2VsbGFibGVzXG59XG5cbmZ1bmN0aW9uIHJ1blRha2VFZmZlY3QoZW52LCBfcmVmMywgY2IpIHtcbiAgdmFyIF9yZWYzJGNoYW5uZWwgPSBfcmVmMy5jaGFubmVsLFxuICAgICAgY2hhbm5lbCA9IF9yZWYzJGNoYW5uZWwgPT09IHZvaWQgMCA/IGVudi5jaGFubmVsIDogX3JlZjMkY2hhbm5lbCxcbiAgICAgIHBhdHRlcm4gPSBfcmVmMy5wYXR0ZXJuLFxuICAgICAgbWF5YmUgPSBfcmVmMy5tYXliZTtcblxuICB2YXIgdGFrZUNiID0gZnVuY3Rpb24gdGFrZUNiKGlucHV0KSB7XG4gICAgaWYgKGlucHV0IGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIGNiKGlucHV0LCB0cnVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXNFbmQoaW5wdXQpICYmICFtYXliZSkge1xuICAgICAgY2IoVEVSTUlOQVRFKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYihpbnB1dCk7XG4gIH07XG5cbiAgdHJ5IHtcbiAgICBjaGFubmVsLnRha2UodGFrZUNiLCBub3RVbmRlZihwYXR0ZXJuKSA/IG1hdGNoZXIocGF0dGVybikgOiBudWxsKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY2IoZXJyLCB0cnVlKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjYi5jYW5jZWwgPSB0YWtlQ2IuY2FuY2VsO1xufVxuXG5mdW5jdGlvbiBydW5DYWxsRWZmZWN0KGVudiwgX3JlZjQsIGNiLCBfcmVmNSkge1xuICB2YXIgY29udGV4dCA9IF9yZWY0LmNvbnRleHQsXG4gICAgICBmbiA9IF9yZWY0LmZuLFxuICAgICAgYXJncyA9IF9yZWY0LmFyZ3M7XG4gIHZhciB0YXNrID0gX3JlZjUudGFzaztcblxuICAvLyBjYXRjaCBzeW5jaHJvbm91cyBmYWlsdXJlczsgc2VlICMxNTJcbiAgdHJ5IHtcbiAgICB2YXIgcmVzdWx0ID0gZm4uYXBwbHkoY29udGV4dCwgYXJncyk7XG5cbiAgICBpZiAocHJvbWlzZShyZXN1bHQpKSB7XG4gICAgICByZXNvbHZlUHJvbWlzZShyZXN1bHQsIGNiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXRlcmF0b3IocmVzdWx0KSkge1xuICAgICAgLy8gcmVzb2x2ZSBpdGVyYXRvclxuICAgICAgcHJvYyhlbnYsIHJlc3VsdCwgdGFzay5jb250ZXh0LCBjdXJyZW50LCBnZXRNZXRhSW5mbyhmbiksXG4gICAgICAvKiBpc1Jvb3QgKi9cbiAgICAgIGZhbHNlLCBjYik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY2IocmVzdWx0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjYihlcnJvciwgdHJ1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcnVuQ1BTRWZmZWN0KGVudiwgX3JlZjYsIGNiKSB7XG4gIHZhciBjb250ZXh0ID0gX3JlZjYuY29udGV4dCxcbiAgICAgIGZuID0gX3JlZjYuZm4sXG4gICAgICBhcmdzID0gX3JlZjYuYXJncztcblxuICAvLyBDUFMgKGllIG5vZGUgc3R5bGUgZnVuY3Rpb25zKSBjYW4gZGVmaW5lIHRoZWlyIG93biBjYW5jZWxsYXRpb24gbG9naWNcbiAgLy8gYnkgc2V0dGluZyBjYW5jZWwgZmllbGQgb24gdGhlIGNiXG4gIC8vIGNhdGNoIHN5bmNocm9ub3VzIGZhaWx1cmVzOyBzZWUgIzE1MlxuICB0cnkge1xuICAgIHZhciBjcHNDYiA9IGZ1bmN0aW9uIGNwc0NiKGVyciwgcmVzKSB7XG4gICAgICBpZiAodW5kZWYoZXJyKSkge1xuICAgICAgICBjYihyZXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2IoZXJyLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm4uYXBwbHkoY29udGV4dCwgYXJncy5jb25jYXQoY3BzQ2IpKTtcblxuICAgIGlmIChjcHNDYi5jYW5jZWwpIHtcbiAgICAgIGNiLmNhbmNlbCA9IGNwc0NiLmNhbmNlbDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY2IoZXJyb3IsIHRydWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJ1bkZvcmtFZmZlY3QoZW52LCBfcmVmNywgY2IsIF9yZWY4KSB7XG4gIHZhciBjb250ZXh0ID0gX3JlZjcuY29udGV4dCxcbiAgICAgIGZuID0gX3JlZjcuZm4sXG4gICAgICBhcmdzID0gX3JlZjcuYXJncyxcbiAgICAgIGRldGFjaGVkID0gX3JlZjcuZGV0YWNoZWQ7XG4gIHZhciBwYXJlbnQgPSBfcmVmOC50YXNrO1xuICB2YXIgdGFza0l0ZXJhdG9yID0gY3JlYXRlVGFza0l0ZXJhdG9yKHtcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgIGZuOiBmbixcbiAgICBhcmdzOiBhcmdzXG4gIH0pO1xuICB2YXIgbWV0YSA9IGdldEl0ZXJhdG9yTWV0YUluZm8odGFza0l0ZXJhdG9yLCBmbik7XG4gIGltbWVkaWF0ZWx5KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2hpbGQgPSBwcm9jKGVudiwgdGFza0l0ZXJhdG9yLCBwYXJlbnQuY29udGV4dCwgY3VycmVudCwgbWV0YSwgZGV0YWNoZWQsIHVuZGVmaW5lZCk7XG5cbiAgICBpZiAoZGV0YWNoZWQpIHtcbiAgICAgIGNiKGNoaWxkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGNoaWxkLmlzUnVubmluZygpKSB7XG4gICAgICAgIHBhcmVudC5xdWV1ZS5hZGRUYXNrKGNoaWxkKTtcbiAgICAgICAgY2IoY2hpbGQpO1xuICAgICAgfSBlbHNlIGlmIChjaGlsZC5pc0Fib3J0ZWQoKSkge1xuICAgICAgICBwYXJlbnQucXVldWUuYWJvcnQoY2hpbGQuZXJyb3IoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYihjaGlsZCk7XG4gICAgICB9XG4gICAgfVxuICB9KTsgLy8gRm9yayBlZmZlY3RzIGFyZSBub24gY2FuY2VsbGFibGVzXG59XG5cbmZ1bmN0aW9uIHJ1bkpvaW5FZmZlY3QoZW52LCB0YXNrT3JUYXNrcywgY2IsIF9yZWY5KSB7XG4gIHZhciB0YXNrID0gX3JlZjkudGFzaztcblxuICB2YXIgam9pblNpbmdsZVRhc2sgPSBmdW5jdGlvbiBqb2luU2luZ2xlVGFzayh0YXNrVG9Kb2luLCBjYikge1xuICAgIGlmICh0YXNrVG9Kb2luLmlzUnVubmluZygpKSB7XG4gICAgICB2YXIgam9pbmVyID0ge1xuICAgICAgICB0YXNrOiB0YXNrLFxuICAgICAgICBjYjogY2JcbiAgICAgIH07XG5cbiAgICAgIGNiLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRhc2tUb0pvaW4uaXNSdW5uaW5nKCkpIHJlbW92ZSh0YXNrVG9Kb2luLmpvaW5lcnMsIGpvaW5lcik7XG4gICAgICB9O1xuXG4gICAgICB0YXNrVG9Kb2luLmpvaW5lcnMucHVzaChqb2luZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGFza1RvSm9pbi5pc0Fib3J0ZWQoKSkge1xuICAgICAgICBjYih0YXNrVG9Kb2luLmVycm9yKCksIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2IodGFza1RvSm9pbi5yZXN1bHQoKSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGlmIChhcnJheSQxKHRhc2tPclRhc2tzKSkge1xuICAgIGlmICh0YXNrT3JUYXNrcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNiKFtdKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgY2hpbGRDYWxsYmFja3MgPSBjcmVhdGVBbGxTdHlsZUNoaWxkQ2FsbGJhY2tzKHRhc2tPclRhc2tzLCBjYik7XG4gICAgdGFza09yVGFza3MuZm9yRWFjaChmdW5jdGlvbiAodCwgaSkge1xuICAgICAgam9pblNpbmdsZVRhc2sodCwgY2hpbGRDYWxsYmFja3NbaV0pO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGpvaW5TaW5nbGVUYXNrKHRhc2tPclRhc2tzLCBjYik7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2FuY2VsU2luZ2xlVGFzayh0YXNrVG9DYW5jZWwpIHtcbiAgaWYgKHRhc2tUb0NhbmNlbC5pc1J1bm5pbmcoKSkge1xuICAgIHRhc2tUb0NhbmNlbC5jYW5jZWwoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBydW5DYW5jZWxFZmZlY3QoZW52LCB0YXNrT3JUYXNrcywgY2IsIF9yZWYxMCkge1xuICB2YXIgdGFzayA9IF9yZWYxMC50YXNrO1xuXG4gIGlmICh0YXNrT3JUYXNrcyA9PT0gU0VMRl9DQU5DRUxMQVRJT04pIHtcbiAgICBjYW5jZWxTaW5nbGVUYXNrKHRhc2spO1xuICB9IGVsc2UgaWYgKGFycmF5JDEodGFza09yVGFza3MpKSB7XG4gICAgdGFza09yVGFza3MuZm9yRWFjaChjYW5jZWxTaW5nbGVUYXNrKTtcbiAgfSBlbHNlIHtcbiAgICBjYW5jZWxTaW5nbGVUYXNrKHRhc2tPclRhc2tzKTtcbiAgfVxuXG4gIGNiKCk7IC8vIGNhbmNlbCBlZmZlY3RzIGFyZSBub24gY2FuY2VsbGFibGVzXG59XG5cbmZ1bmN0aW9uIHJ1bkFsbEVmZmVjdChlbnYsIGVmZmVjdHMsIGNiLCBfcmVmMTEpIHtcbiAgdmFyIGRpZ2VzdEVmZmVjdCA9IF9yZWYxMS5kaWdlc3RFZmZlY3Q7XG4gIHZhciBlZmZlY3RJZCA9IGN1cnJlbnQ7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZWZmZWN0cyk7XG5cbiAgaWYgKGtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgY2IoYXJyYXkkMShlZmZlY3RzKSA/IFtdIDoge30pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjaGlsZENhbGxiYWNrcyA9IGNyZWF0ZUFsbFN0eWxlQ2hpbGRDYWxsYmFja3MoZWZmZWN0cywgY2IpO1xuICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGRpZ2VzdEVmZmVjdChlZmZlY3RzW2tleV0sIGVmZmVjdElkLCBjaGlsZENhbGxiYWNrc1trZXldLCBrZXkpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcnVuUmFjZUVmZmVjdChlbnYsIGVmZmVjdHMsIGNiLCBfcmVmMTIpIHtcbiAgdmFyIGRpZ2VzdEVmZmVjdCA9IF9yZWYxMi5kaWdlc3RFZmZlY3Q7XG4gIHZhciBlZmZlY3RJZCA9IGN1cnJlbnQ7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZWZmZWN0cyk7XG4gIHZhciByZXNwb25zZSA9IGFycmF5JDEoZWZmZWN0cykgPyBjcmVhdGVFbXB0eUFycmF5KGtleXMubGVuZ3RoKSA6IHt9O1xuICB2YXIgY2hpbGRDYnMgPSB7fTtcbiAgdmFyIGNvbXBsZXRlZCA9IGZhbHNlO1xuICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIHZhciBjaENiQXRLZXkgPSBmdW5jdGlvbiBjaENiQXRLZXkocmVzLCBpc0Vycikge1xuICAgICAgaWYgKGNvbXBsZXRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0VyciB8fCBzaG91bGRDb21wbGV0ZShyZXMpKSB7XG4gICAgICAgIC8vIFJhY2UgQXV0byBjYW5jZWxsYXRpb25cbiAgICAgICAgY2IuY2FuY2VsKCk7XG4gICAgICAgIGNiKHJlcywgaXNFcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2IuY2FuY2VsKCk7XG4gICAgICAgIGNvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgIHJlc3BvbnNlW2tleV0gPSByZXM7XG4gICAgICAgIGNiKHJlc3BvbnNlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY2hDYkF0S2V5LmNhbmNlbCA9IG5vb3A7XG4gICAgY2hpbGRDYnNba2V5XSA9IGNoQ2JBdEtleTtcbiAgfSk7XG5cbiAgY2IuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHByZXZlbnRzIHVubmVjZXNzYXJ5IGNhbmNlbGxhdGlvblxuICAgIGlmICghY29tcGxldGVkKSB7XG4gICAgICBjb21wbGV0ZWQgPSB0cnVlO1xuICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIGNoaWxkQ2JzW2tleV0uY2FuY2VsKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBpZiAoY29tcGxldGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZGlnZXN0RWZmZWN0KGVmZmVjdHNba2V5XSwgZWZmZWN0SWQsIGNoaWxkQ2JzW2tleV0sIGtleSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBydW5TZWxlY3RFZmZlY3QoZW52LCBfcmVmMTMsIGNiKSB7XG4gIHZhciBzZWxlY3RvciA9IF9yZWYxMy5zZWxlY3RvcixcbiAgICAgIGFyZ3MgPSBfcmVmMTMuYXJncztcblxuICB0cnkge1xuICAgIHZhciBzdGF0ZSA9IHNlbGVjdG9yLmFwcGx5KHZvaWQgMCwgW2Vudi5nZXRTdGF0ZSgpXS5jb25jYXQoYXJncykpO1xuICAgIGNiKHN0YXRlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjYihlcnJvciwgdHJ1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcnVuQ2hhbm5lbEVmZmVjdChlbnYsIF9yZWYxNCwgY2IpIHtcbiAgdmFyIHBhdHRlcm4gPSBfcmVmMTQucGF0dGVybixcbiAgICAgIGJ1ZmZlciA9IF9yZWYxNC5idWZmZXI7XG4gIHZhciBjaGFuID0gY2hhbm5lbChidWZmZXIpO1xuICB2YXIgbWF0Y2ggPSBtYXRjaGVyKHBhdHRlcm4pO1xuXG4gIHZhciB0YWtlciA9IGZ1bmN0aW9uIHRha2VyKGFjdGlvbikge1xuICAgIGlmICghaXNFbmQoYWN0aW9uKSkge1xuICAgICAgZW52LmNoYW5uZWwudGFrZSh0YWtlciwgbWF0Y2gpO1xuICAgIH1cblxuICAgIGNoYW4ucHV0KGFjdGlvbik7XG4gIH07XG5cbiAgdmFyIGNsb3NlID0gY2hhbi5jbG9zZTtcblxuICBjaGFuLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIHRha2VyLmNhbmNlbCgpO1xuICAgIGNsb3NlKCk7XG4gIH07XG5cbiAgZW52LmNoYW5uZWwudGFrZSh0YWtlciwgbWF0Y2gpO1xuICBjYihjaGFuKTtcbn1cblxuZnVuY3Rpb24gcnVuQ2FuY2VsbGVkRWZmZWN0KGVudiwgZGF0YSwgY2IsIF9yZWYxNSkge1xuICB2YXIgdGFzayA9IF9yZWYxNS50YXNrO1xuICBjYih0YXNrLmlzQ2FuY2VsbGVkKCkpO1xufVxuXG5mdW5jdGlvbiBydW5GbHVzaEVmZmVjdChlbnYsIGNoYW5uZWwsIGNiKSB7XG4gIGNoYW5uZWwuZmx1c2goY2IpO1xufVxuXG5mdW5jdGlvbiBydW5HZXRDb250ZXh0RWZmZWN0KGVudiwgcHJvcCwgY2IsIF9yZWYxNikge1xuICB2YXIgdGFzayA9IF9yZWYxNi50YXNrO1xuICBjYih0YXNrLmNvbnRleHRbcHJvcF0pO1xufVxuXG5mdW5jdGlvbiBydW5TZXRDb250ZXh0RWZmZWN0KGVudiwgcHJvcHMsIGNiLCBfcmVmMTcpIHtcbiAgdmFyIHRhc2sgPSBfcmVmMTcudGFzaztcbiAgYXNzaWduV2l0aFN5bWJvbHModGFzay5jb250ZXh0LCBwcm9wcyk7XG4gIGNiKCk7XG59XG5cbnZhciBlZmZlY3RSdW5uZXJNYXAgPSAoX2VmZmVjdFJ1bm5lck1hcCA9IHt9LCBfZWZmZWN0UnVubmVyTWFwW1RBS0VdID0gcnVuVGFrZUVmZmVjdCwgX2VmZmVjdFJ1bm5lck1hcFtQVVRdID0gcnVuUHV0RWZmZWN0LCBfZWZmZWN0UnVubmVyTWFwW0FMTF0gPSBydW5BbGxFZmZlY3QsIF9lZmZlY3RSdW5uZXJNYXBbUkFDRV0gPSBydW5SYWNlRWZmZWN0LCBfZWZmZWN0UnVubmVyTWFwW0NBTExdID0gcnVuQ2FsbEVmZmVjdCwgX2VmZmVjdFJ1bm5lck1hcFtDUFNdID0gcnVuQ1BTRWZmZWN0LCBfZWZmZWN0UnVubmVyTWFwW0ZPUktdID0gcnVuRm9ya0VmZmVjdCwgX2VmZmVjdFJ1bm5lck1hcFtKT0lOXSA9IHJ1bkpvaW5FZmZlY3QsIF9lZmZlY3RSdW5uZXJNYXBbQ0FOQ0VMJDFdID0gcnVuQ2FuY2VsRWZmZWN0LCBfZWZmZWN0UnVubmVyTWFwW1NFTEVDVF0gPSBydW5TZWxlY3RFZmZlY3QsIF9lZmZlY3RSdW5uZXJNYXBbQUNUSU9OX0NIQU5ORUxdID0gcnVuQ2hhbm5lbEVmZmVjdCwgX2VmZmVjdFJ1bm5lck1hcFtDQU5DRUxMRUQkMV0gPSBydW5DYW5jZWxsZWRFZmZlY3QsIF9lZmZlY3RSdW5uZXJNYXBbRkxVU0hdID0gcnVuRmx1c2hFZmZlY3QsIF9lZmZlY3RSdW5uZXJNYXBbR0VUX0NPTlRFWFRdID0gcnVuR2V0Q29udGV4dEVmZmVjdCwgX2VmZmVjdFJ1bm5lck1hcFtTRVRfQ09OVEVYVF0gPSBydW5TZXRDb250ZXh0RWZmZWN0LCBfZWZmZWN0UnVubmVyTWFwKTtcblxuLyoqXG4gVXNlZCB0byB0cmFjayBhIHBhcmVudCB0YXNrIGFuZCBpdHMgZm9ya3NcbiBJbiB0aGUgZm9yayBtb2RlbCwgZm9ya2VkIHRhc2tzIGFyZSBhdHRhY2hlZCBieSBkZWZhdWx0IHRvIHRoZWlyIHBhcmVudFxuIFdlIG1vZGVsIHRoaXMgdXNpbmcgdGhlIGNvbmNlcHQgb2YgUGFyZW50IHRhc2sgJiYgbWFpbiBUYXNrXG4gbWFpbiB0YXNrIGlzIHRoZSBtYWluIGZsb3cgb2YgdGhlIGN1cnJlbnQgR2VuZXJhdG9yLCB0aGUgcGFyZW50IHRhc2tzIGlzIHRoZVxuIGFnZ3JlZ2F0aW9uIG9mIHRoZSBtYWluIHRhc2tzICsgYWxsIGl0cyBmb3JrZWQgdGFza3MuXG4gVGh1cyB0aGUgd2hvbGUgbW9kZWwgcmVwcmVzZW50cyBhbiBleGVjdXRpb24gdHJlZSB3aXRoIG11bHRpcGxlIGJyYW5jaGVzICh2cyB0aGVcbiBsaW5lYXIgZXhlY3V0aW9uIHRyZWUgaW4gc2VxdWVudGlhbCAobm9uIHBhcmFsbGVsKSBwcm9ncmFtbWluZylcblxuIEEgcGFyZW50IHRhc2tzIGhhcyB0aGUgZm9sbG93aW5nIHNlbWFudGljc1xuIC0gSXQgY29tcGxldGVzIGlmIGFsbCBpdHMgZm9ya3MgZWl0aGVyIGNvbXBsZXRlIG9yIGFsbCBjYW5jZWxsZWRcbiAtIElmIGl0J3MgY2FuY2VsbGVkLCBhbGwgZm9ya3MgYXJlIGNhbmNlbGxlZCBhcyB3ZWxsXG4gLSBJdCBhYm9ydHMgaWYgYW55IHVuY2F1Z2h0IGVycm9yIGJ1YmJsZXMgdXAgZnJvbSBmb3Jrc1xuIC0gSWYgaXQgY29tcGxldGVzLCB0aGUgcmV0dXJuIHZhbHVlIGlzIHRoZSBvbmUgcmV0dXJuZWQgYnkgdGhlIG1haW4gdGFza1xuICoqL1xuXG5mdW5jdGlvbiBmb3JrUXVldWUobWFpblRhc2ssIG9uQWJvcnQsIGNvbnQpIHtcbiAgdmFyIHRhc2tzID0gW107XG4gIHZhciByZXN1bHQ7XG4gIHZhciBjb21wbGV0ZWQgPSBmYWxzZTtcbiAgYWRkVGFzayhtYWluVGFzayk7XG5cbiAgdmFyIGdldFRhc2tzID0gZnVuY3Rpb24gZ2V0VGFza3MoKSB7XG4gICAgcmV0dXJuIHRhc2tzO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGFib3J0KGVycikge1xuICAgIG9uQWJvcnQoKTtcbiAgICBjYW5jZWxBbGwoKTtcbiAgICBjb250KGVyciwgdHJ1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRUYXNrKHRhc2spIHtcbiAgICB0YXNrcy5wdXNoKHRhc2spO1xuXG4gICAgdGFzay5jb250ID0gZnVuY3Rpb24gKHJlcywgaXNFcnIpIHtcbiAgICAgIGlmIChjb21wbGV0ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICByZW1vdmUodGFza3MsIHRhc2spO1xuICAgICAgdGFzay5jb250ID0gbm9vcDtcblxuICAgICAgaWYgKGlzRXJyKSB7XG4gICAgICAgIGFib3J0KHJlcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGFzayA9PT0gbWFpblRhc2spIHtcbiAgICAgICAgICByZXN1bHQgPSByZXM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRhc2tzLmxlbmd0aCkge1xuICAgICAgICAgIGNvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgICAgY29udChyZXN1bHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbmNlbEFsbCgpIHtcbiAgICBpZiAoY29tcGxldGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29tcGxldGVkID0gdHJ1ZTtcbiAgICB0YXNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICB0LmNvbnQgPSBub29wO1xuICAgICAgdC5jYW5jZWwoKTtcbiAgICB9KTtcbiAgICB0YXNrcyA9IFtdO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRUYXNrOiBhZGRUYXNrLFxuICAgIGNhbmNlbEFsbDogY2FuY2VsQWxsLFxuICAgIGFib3J0OiBhYm9ydCxcbiAgICBnZXRUYXNrczogZ2V0VGFza3NcbiAgfTtcbn1cblxuLy8gdGhlcmUgY2FuIGJlIG9ubHkgYSBzaW5nbGUgc2FnYSBlcnJvciBjcmVhdGVkIGF0IGFueSBnaXZlbiBtb21lbnRcblxuZnVuY3Rpb24gZm9ybWF0TG9jYXRpb24oZmlsZU5hbWUsIGxpbmVOdW1iZXIpIHtcbiAgcmV0dXJuIGZpbGVOYW1lICsgXCI/XCIgKyBsaW5lTnVtYmVyO1xufVxuXG5mdW5jdGlvbiBlZmZlY3RMb2NhdGlvbkFzU3RyaW5nKGVmZmVjdCkge1xuICB2YXIgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihlZmZlY3QpO1xuXG4gIGlmIChsb2NhdGlvbikge1xuICAgIHZhciBjb2RlID0gbG9jYXRpb24uY29kZSxcbiAgICAgICAgZmlsZU5hbWUgPSBsb2NhdGlvbi5maWxlTmFtZSxcbiAgICAgICAgbGluZU51bWJlciA9IGxvY2F0aW9uLmxpbmVOdW1iZXI7XG4gICAgdmFyIHNvdXJjZSA9IGNvZGUgKyBcIiAgXCIgKyBmb3JtYXRMb2NhdGlvbihmaWxlTmFtZSwgbGluZU51bWJlcik7XG4gICAgcmV0dXJuIHNvdXJjZTtcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuZnVuY3Rpb24gc2FnYUxvY2F0aW9uQXNTdHJpbmcoc2FnYU1ldGEpIHtcbiAgdmFyIG5hbWUgPSBzYWdhTWV0YS5uYW1lLFxuICAgICAgbG9jYXRpb24gPSBzYWdhTWV0YS5sb2NhdGlvbjtcblxuICBpZiAobG9jYXRpb24pIHtcbiAgICByZXR1cm4gbmFtZSArIFwiICBcIiArIGZvcm1hdExvY2F0aW9uKGxvY2F0aW9uLmZpbGVOYW1lLCBsb2NhdGlvbi5saW5lTnVtYmVyKTtcbiAgfVxuXG4gIHJldHVybiBuYW1lO1xufVxuXG5mdW5jdGlvbiBjYW5jZWxsZWRUYXNrc0FzU3RyaW5nKHNhZ2FTdGFjaykge1xuICB2YXIgY2FuY2VsbGVkVGFza3MgPSBmbGF0TWFwKGZ1bmN0aW9uIChpKSB7XG4gICAgcmV0dXJuIGkuY2FuY2VsbGVkVGFza3M7XG4gIH0sIHNhZ2FTdGFjayk7XG5cbiAgaWYgKCFjYW5jZWxsZWRUYXNrcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICByZXR1cm4gWydUYXNrcyBjYW5jZWxsZWQgZHVlIHRvIGVycm9yOiddLmNvbmNhdChjYW5jZWxsZWRUYXNrcykuam9pbignXFxuJyk7XG59XG5cbnZhciBjcmFzaGVkRWZmZWN0ID0gbnVsbDtcbnZhciBzYWdhU3RhY2sgPSBbXTtcbnZhciBhZGRTYWdhRnJhbWUgPSBmdW5jdGlvbiBhZGRTYWdhRnJhbWUoZnJhbWUpIHtcbiAgZnJhbWUuY3Jhc2hlZEVmZmVjdCA9IGNyYXNoZWRFZmZlY3Q7XG4gIHNhZ2FTdGFjay5wdXNoKGZyYW1lKTtcbn07XG52YXIgY2xlYXIgPSBmdW5jdGlvbiBjbGVhcigpIHtcbiAgY3Jhc2hlZEVmZmVjdCA9IG51bGw7XG4gIHNhZ2FTdGFjay5sZW5ndGggPSAwO1xufTsgLy8gdGhpcyBzZXRzIGNyYXNoZWQgZWZmZWN0IGZvciB0aGUgc29vbi10by1iZS1yZXBvcnRlZCBzYWdhIGZyYW1lXG4vLyB0aGlzIHNsaWdodGx5IHN0cmVhdGNoZXMgdGhlIHNpbmdsZXRvbiBuYXR1cmUgb2YgdGhpcyBtb2R1bGUgaW50byB3cm9uZyBkaXJlY3Rpb25cbi8vIGFzIGl0J3MgZXZlbiBsZXNzIG9idmlvdXMgd2hhdCdzIHRoZSBkYXRhIGZsb3cgaGVyZSwgYnV0IGl0IGlzIHdoYXQgaXQgaXMgZm9yIG5vd1xuXG52YXIgc2V0Q3Jhc2hlZEVmZmVjdCA9IGZ1bmN0aW9uIHNldENyYXNoZWRFZmZlY3QoZWZmZWN0KSB7XG4gIGNyYXNoZWRFZmZlY3QgPSBlZmZlY3Q7XG59O1xuLyoqXG4gIEByZXR1cm5zIHtzdHJpbmd9XG5cbiAgQGV4YW1wbGVcbiAgVGhlIGFib3ZlIGVycm9yIG9jY3VycmVkIGluIHRhc2sgZXJyb3JJblB1dFNhZ2Ege3BhdGhUb0ZpbGV9XG4gIHdoZW4gZXhlY3V0aW5nIGVmZmVjdCBwdXQoe3R5cGU6ICdSRURVQ0VSX0FDVElPTl9FUlJPUl9JTl9QVVQnfSkge3BhdGhUb0ZpbGV9XG4gICAgICBjcmVhdGVkIGJ5IGZldGNoU2FnYSB7cGF0aFRvRmlsZX1cbiAgICAgIGNyZWF0ZWQgYnkgcm9vdFNhZ2Ege3BhdGhUb0ZpbGV9XG4qL1xuXG52YXIgdG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgdmFyIGZpcnN0U2FnYSA9IHNhZ2FTdGFja1swXSxcbiAgICAgIG90aGVyU2FnYXMgPSBzYWdhU3RhY2suc2xpY2UoMSk7XG4gIHZhciBjcmFzaGVkRWZmZWN0TG9jYXRpb24gPSBmaXJzdFNhZ2EuY3Jhc2hlZEVmZmVjdCA/IGVmZmVjdExvY2F0aW9uQXNTdHJpbmcoZmlyc3RTYWdhLmNyYXNoZWRFZmZlY3QpIDogbnVsbDtcbiAgdmFyIGVycm9yTWVzc2FnZSA9IFwiVGhlIGFib3ZlIGVycm9yIG9jY3VycmVkIGluIHRhc2sgXCIgKyBzYWdhTG9jYXRpb25Bc1N0cmluZyhmaXJzdFNhZ2EubWV0YSkgKyAoY3Jhc2hlZEVmZmVjdExvY2F0aW9uID8gXCIgXFxuIHdoZW4gZXhlY3V0aW5nIGVmZmVjdCBcIiArIGNyYXNoZWRFZmZlY3RMb2NhdGlvbiA6ICcnKTtcbiAgcmV0dXJuIFtlcnJvck1lc3NhZ2VdLmNvbmNhdChvdGhlclNhZ2FzLm1hcChmdW5jdGlvbiAocykge1xuICAgIHJldHVybiBcIiAgICBjcmVhdGVkIGJ5IFwiICsgc2FnYUxvY2F0aW9uQXNTdHJpbmcocy5tZXRhKTtcbiAgfSksIFtjYW5jZWxsZWRUYXNrc0FzU3RyaW5nKHNhZ2FTdGFjayldKS5qb2luKCdcXG4nKTtcbn07XG5cbmZ1bmN0aW9uIG5ld1Rhc2soZW52LCBtYWluVGFzaywgcGFyZW50Q29udGV4dCwgcGFyZW50RWZmZWN0SWQsIG1ldGEsIGlzUm9vdCwgY29udCkge1xuICB2YXIgX3Rhc2s7XG5cbiAgaWYgKGNvbnQgPT09IHZvaWQgMCkge1xuICAgIGNvbnQgPSBub29wO1xuICB9XG5cbiAgdmFyIHN0YXR1cyA9IFJVTk5JTkc7XG4gIHZhciB0YXNrUmVzdWx0O1xuICB2YXIgdGFza0Vycm9yO1xuICB2YXIgZGVmZXJyZWRFbmQgPSBudWxsO1xuICB2YXIgY2FuY2VsbGVkRHVlVG9FcnJvclRhc2tzID0gW107XG4gIHZhciBjb250ZXh0ID0gT2JqZWN0LmNyZWF0ZShwYXJlbnRDb250ZXh0KTtcbiAgdmFyIHF1ZXVlID0gZm9ya1F1ZXVlKG1haW5UYXNrLCBmdW5jdGlvbiBvbkFib3J0KCkge1xuICAgIGNhbmNlbGxlZER1ZVRvRXJyb3JUYXNrcy5wdXNoLmFwcGx5KGNhbmNlbGxlZER1ZVRvRXJyb3JUYXNrcywgcXVldWUuZ2V0VGFza3MoKS5tYXAoZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0Lm1ldGEubmFtZTtcbiAgICB9KSk7XG4gIH0sIGVuZCk7XG4gIC8qKlxuICAgVGhpcyBtYXkgYmUgY2FsbGVkIGJ5IGEgcGFyZW50IGdlbmVyYXRvciB0byB0cmlnZ2VyL3Byb3BhZ2F0ZSBjYW5jZWxsYXRpb25cbiAgIGNhbmNlbCBhbGwgcGVuZGluZyB0YXNrcyAoaW5jbHVkaW5nIHRoZSBtYWluIHRhc2spLCB0aGVuIGVuZCB0aGUgY3VycmVudCB0YXNrLlxuICAgIENhbmNlbGxhdGlvbiBwcm9wYWdhdGVzIGRvd24gdG8gdGhlIHdob2xlIGV4ZWN1dGlvbiB0cmVlIGhlbGQgYnkgdGhpcyBQYXJlbnQgdGFza1xuICAgSXQncyBhbHNvIHByb3BhZ2F0ZWQgdG8gYWxsIGpvaW5lcnMgb2YgdGhpcyB0YXNrIGFuZCB0aGVpciBleGVjdXRpb24gdHJlZS9qb2luZXJzXG4gICAgQ2FuY2VsbGF0aW9uIGlzIG5vb3AgZm9yIHRlcm1pbmF0ZWQvQ2FuY2VsbGVkIHRhc2tzIHRhc2tzXG4gICAqKi9cblxuICBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgaWYgKHN0YXR1cyA9PT0gUlVOTklORykge1xuICAgICAgLy8gU2V0dGluZyBzdGF0dXMgdG8gQ0FOQ0VMTEVEIGRvZXMgbm90IG5lY2Vzc2FyaWx5IG1lYW4gdGhhdCB0aGUgdGFzay9pdGVyYXRvcnMgYXJlIHN0b3BwZWRcbiAgICAgIC8vIGVmZmVjdHMgaW4gdGhlIGl0ZXJhdG9yJ3MgZmluYWxseSBibG9jayB3aWxsIHN0aWxsIGJlIGV4ZWN1dGVkXG4gICAgICBzdGF0dXMgPSBDQU5DRUxMRUQ7XG4gICAgICBxdWV1ZS5jYW5jZWxBbGwoKTsgLy8gRW5kaW5nIHdpdGggYSBUQVNLX0NBTkNFTCB3aWxsIHByb3BhZ2F0ZSB0aGUgQ2FuY2VsbGF0aW9uIHRvIGFsbCBqb2luZXJzXG5cbiAgICAgIGVuZChUQVNLX0NBTkNFTCwgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGVuZChyZXN1bHQsIGlzRXJyKSB7XG4gICAgaWYgKCFpc0Vycikge1xuICAgICAgLy8gVGhlIHN0YXR1cyBoZXJlIG1heSBiZSBSVU5OSU5HIG9yIENBTkNFTExFRFxuICAgICAgLy8gSWYgdGhlIHN0YXR1cyBpcyBDQU5DRUxMRUQsIHRoZW4gd2UgZG8gbm90IG5lZWQgdG8gY2hhbmdlIGl0IGhlcmVcbiAgICAgIGlmIChyZXN1bHQgPT09IFRBU0tfQ0FOQ0VMKSB7XG4gICAgICAgIHN0YXR1cyA9IENBTkNFTExFRDtcbiAgICAgIH0gZWxzZSBpZiAoc3RhdHVzICE9PSBDQU5DRUxMRUQpIHtcbiAgICAgICAgc3RhdHVzID0gRE9ORTtcbiAgICAgIH1cblxuICAgICAgdGFza1Jlc3VsdCA9IHJlc3VsdDtcbiAgICAgIGRlZmVycmVkRW5kICYmIGRlZmVycmVkRW5kLnJlc29sdmUocmVzdWx0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdHVzID0gQUJPUlRFRDtcbiAgICAgIGFkZFNhZ2FGcmFtZSh7XG4gICAgICAgIG1ldGE6IG1ldGEsXG4gICAgICAgIGNhbmNlbGxlZFRhc2tzOiBjYW5jZWxsZWREdWVUb0Vycm9yVGFza3NcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodGFzay5pc1Jvb3QpIHtcbiAgICAgICAgdmFyIHNhZ2FTdGFjayA9IHRvU3RyaW5nKCk7IC8vIHdlJ3ZlIGR1bXBlZCB0aGUgc2FnYSBzdGFjayB0byBzdHJpbmcgYW5kIGFyZSBwYXNzaW5nIGl0IHRvIHVzZXIncyBjb2RlXG4gICAgICAgIC8vIHdlIGtub3cgdGhhdCBpdCB3b24ndCBiZSBuZWVkZWQgYW55bW9yZSBhbmQgd2UgbmVlZCB0byBjbGVhciBpdFxuXG4gICAgICAgIGNsZWFyKCk7XG4gICAgICAgIGVudi5vbkVycm9yKHJlc3VsdCwge1xuICAgICAgICAgIHNhZ2FTdGFjazogc2FnYVN0YWNrXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0YXNrRXJyb3IgPSByZXN1bHQ7XG4gICAgICBkZWZlcnJlZEVuZCAmJiBkZWZlcnJlZEVuZC5yZWplY3QocmVzdWx0KTtcbiAgICB9XG5cbiAgICB0YXNrLmNvbnQocmVzdWx0LCBpc0Vycik7XG4gICAgdGFzay5qb2luZXJzLmZvckVhY2goZnVuY3Rpb24gKGpvaW5lcikge1xuICAgICAgam9pbmVyLmNiKHJlc3VsdCwgaXNFcnIpO1xuICAgIH0pO1xuICAgIHRhc2suam9pbmVycyA9IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRDb250ZXh0KHByb3BzKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNoZWNrKHByb3BzLCBvYmplY3QsIGNyZWF0ZVNldENvbnRleHRXYXJuaW5nKCd0YXNrJywgcHJvcHMpKTtcbiAgICB9XG5cbiAgICBhc3NpZ25XaXRoU3ltYm9scyhjb250ZXh0LCBwcm9wcyk7XG4gIH1cblxuICBmdW5jdGlvbiB0b1Byb21pc2UoKSB7XG4gICAgaWYgKGRlZmVycmVkRW5kKSB7XG4gICAgICByZXR1cm4gZGVmZXJyZWRFbmQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBkZWZlcnJlZEVuZCA9IGRlZmVycmVkKCk7XG5cbiAgICBpZiAoc3RhdHVzID09PSBBQk9SVEVEKSB7XG4gICAgICBkZWZlcnJlZEVuZC5yZWplY3QodGFza0Vycm9yKTtcbiAgICB9IGVsc2UgaWYgKHN0YXR1cyAhPT0gUlVOTklORykge1xuICAgICAgZGVmZXJyZWRFbmQucmVzb2x2ZSh0YXNrUmVzdWx0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmZXJyZWRFbmQucHJvbWlzZTtcbiAgfVxuXG4gIHZhciB0YXNrID0gKF90YXNrID0ge30sIF90YXNrW1RBU0tdID0gdHJ1ZSwgX3Rhc2suaWQgPSBwYXJlbnRFZmZlY3RJZCwgX3Rhc2subWV0YSA9IG1ldGEsIF90YXNrLmlzUm9vdCA9IGlzUm9vdCwgX3Rhc2suY29udGV4dCA9IGNvbnRleHQsIF90YXNrLmpvaW5lcnMgPSBbXSwgX3Rhc2sucXVldWUgPSBxdWV1ZSwgX3Rhc2suY2FuY2VsID0gY2FuY2VsLCBfdGFzay5jb250ID0gY29udCwgX3Rhc2suZW5kID0gZW5kLCBfdGFzay5zZXRDb250ZXh0ID0gc2V0Q29udGV4dCwgX3Rhc2sudG9Qcm9taXNlID0gdG9Qcm9taXNlLCBfdGFzay5pc1J1bm5pbmcgPSBmdW5jdGlvbiBpc1J1bm5pbmcoKSB7XG4gICAgcmV0dXJuIHN0YXR1cyA9PT0gUlVOTklORztcbiAgfSwgX3Rhc2suaXNDYW5jZWxsZWQgPSBmdW5jdGlvbiBpc0NhbmNlbGxlZCgpIHtcbiAgICByZXR1cm4gc3RhdHVzID09PSBDQU5DRUxMRUQgfHwgc3RhdHVzID09PSBSVU5OSU5HICYmIG1haW5UYXNrLnN0YXR1cyA9PT0gQ0FOQ0VMTEVEO1xuICB9LCBfdGFzay5pc0Fib3J0ZWQgPSBmdW5jdGlvbiBpc0Fib3J0ZWQoKSB7XG4gICAgcmV0dXJuIHN0YXR1cyA9PT0gQUJPUlRFRDtcbiAgfSwgX3Rhc2sucmVzdWx0ID0gZnVuY3Rpb24gcmVzdWx0KCkge1xuICAgIHJldHVybiB0YXNrUmVzdWx0O1xuICB9LCBfdGFzay5lcnJvciA9IGZ1bmN0aW9uIGVycm9yKCkge1xuICAgIHJldHVybiB0YXNrRXJyb3I7XG4gIH0sIF90YXNrKTtcbiAgcmV0dXJuIHRhc2s7XG59XG5cbmZ1bmN0aW9uIHByb2MoZW52LCBpdGVyYXRvciQxLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRFZmZlY3RJZCwgbWV0YSwgaXNSb290LCBjb250KSB7XG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGl0ZXJhdG9yJDFbYXN5bmNJdGVyYXRvclN5bWJvbF0pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJyZWR1eC1zYWdhIGRvZXNuJ3Qgc3VwcG9ydCBhc3luYyBnZW5lcmF0b3JzLCBwbGVhc2UgdXNlIG9ubHkgcmVndWxhciBvbmVzXCIpO1xuICB9XG5cbiAgdmFyIGZpbmFsUnVuRWZmZWN0ID0gZW52LmZpbmFsaXplUnVuRWZmZWN0KHJ1bkVmZmVjdCk7XG4gIC8qKlxuICAgIFRyYWNrcyB0aGUgY3VycmVudCBlZmZlY3QgY2FuY2VsbGF0aW9uXG4gICAgRWFjaCB0aW1lIHRoZSBnZW5lcmF0b3IgcHJvZ3Jlc3Nlcy4gY2FsbGluZyBydW5FZmZlY3Qgd2lsbCBzZXQgYSBuZXcgdmFsdWVcbiAgICBvbiBpdC4gSXQgYWxsb3dzIHByb3BhZ2F0aW5nIGNhbmNlbGxhdGlvbiB0byBjaGlsZCBlZmZlY3RzXG4gICoqL1xuXG4gIG5leHQuY2FuY2VsID0gbm9vcDtcbiAgLyoqIENyZWF0ZXMgYSBtYWluIHRhc2sgdG8gdHJhY2sgdGhlIG1haW4gZmxvdyAqL1xuXG4gIHZhciBtYWluVGFzayA9IHtcbiAgICBtZXRhOiBtZXRhLFxuICAgIGNhbmNlbDogY2FuY2VsTWFpbixcbiAgICBzdGF0dXM6IFJVTk5JTkdcbiAgfTtcbiAgLyoqXG4gICBDcmVhdGVzIGEgbmV3IHRhc2sgZGVzY3JpcHRvciBmb3IgdGhpcyBnZW5lcmF0b3IuXG4gICBBIHRhc2sgaXMgdGhlIGFnZ3JlZ2F0aW9uIG9mIGl0J3MgbWFpblRhc2sgYW5kIGFsbCBpdCdzIGZvcmtlZCB0YXNrcy5cbiAgICoqL1xuXG4gIHZhciB0YXNrID0gbmV3VGFzayhlbnYsIG1haW5UYXNrLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRFZmZlY3RJZCwgbWV0YSwgaXNSb290LCBjb250KTtcbiAgdmFyIGV4ZWN1dGluZ0NvbnRleHQgPSB7XG4gICAgdGFzazogdGFzayxcbiAgICBkaWdlc3RFZmZlY3Q6IGRpZ2VzdEVmZmVjdFxuICB9O1xuICAvKipcbiAgICBjYW5jZWxsYXRpb24gb2YgdGhlIG1haW4gdGFzay4gV2UnbGwgc2ltcGx5IHJlc3VtZSB0aGUgR2VuZXJhdG9yIHdpdGggYSBUQVNLX0NBTkNFTFxuICAqKi9cblxuICBmdW5jdGlvbiBjYW5jZWxNYWluKCkge1xuICAgIGlmIChtYWluVGFzay5zdGF0dXMgPT09IFJVTk5JTkcpIHtcbiAgICAgIG1haW5UYXNrLnN0YXR1cyA9IENBTkNFTExFRDtcbiAgICAgIG5leHQoVEFTS19DQU5DRUwpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICBhdHRhY2hlcyBjYW5jZWxsYXRpb24gbG9naWMgdG8gdGhpcyB0YXNrJ3MgY29udGludWF0aW9uXG4gICAgdGhpcyB3aWxsIHBlcm1pdCBjYW5jZWxsYXRpb24gdG8gcHJvcGFnYXRlIGRvd24gdGhlIGNhbGwgY2hhaW5cbiAgKiovXG5cblxuICBpZiAoY29udCkge1xuICAgIGNvbnQuY2FuY2VsID0gdGFzay5jYW5jZWw7XG4gIH0gLy8ga2lja3MgdXAgdGhlIGdlbmVyYXRvclxuXG5cbiAgbmV4dCgpOyAvLyB0aGVuIHJldHVybiB0aGUgdGFzayBkZXNjcmlwdG9yIHRvIHRoZSBjYWxsZXJcblxuICByZXR1cm4gdGFzaztcbiAgLyoqXG4gICAqIFRoaXMgaXMgdGhlIGdlbmVyYXRvciBkcml2ZXJcbiAgICogSXQncyBhIHJlY3Vyc2l2ZSBhc3luYy9jb250aW51YXRpb24gZnVuY3Rpb24gd2hpY2ggY2FsbHMgaXRzZWxmXG4gICAqIHVudGlsIHRoZSBnZW5lcmF0b3IgdGVybWluYXRlcyBvciB0aHJvd3NcbiAgICogQHBhcmFtIHtpbnRlcm5hbCBjb21tYW5kcyhUQVNLX0NBTkNFTCB8IFRFUk1JTkFURSkgfCBhbnl9IGFyZyAtIHZhbHVlLCBnZW5lcmF0b3Igd2lsbCBiZSByZXN1bWVkIHdpdGguXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNFcnIgLSB0aGUgZmxhZyBzaG93cyBpZiBlZmZlY3QgZmluaXNoZWQgd2l0aCBhbiBlcnJvclxuICAgKlxuICAgKiByZWNlaXZlcyBlaXRoZXIgKGNvbW1hbmQgfCBlZmZlY3QgcmVzdWx0LCBmYWxzZSkgb3IgKGFueSB0aHJvd24gdGhpbmcsIHRydWUpXG4gICAqL1xuXG4gIGZ1bmN0aW9uIG5leHQoYXJnLCBpc0Vycikge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcmVzdWx0O1xuXG4gICAgICBpZiAoaXNFcnIpIHtcbiAgICAgICAgcmVzdWx0ID0gaXRlcmF0b3IkMS50aHJvdyhhcmcpOyAvLyB1c2VyIGhhbmRsZWQgdGhlIGVycm9yLCB3ZSBjYW4gY2xlYXIgYm9va2tlcHQgdmFsdWVzXG5cbiAgICAgICAgY2xlYXIoKTtcbiAgICAgIH0gZWxzZSBpZiAoc2hvdWxkQ2FuY2VsKGFyZykpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAgZ2V0dGluZyBUQVNLX0NBTkNFTCBhdXRvbWF0aWNhbGx5IGNhbmNlbHMgdGhlIG1haW4gdGFza1xuICAgICAgICAgIFdlIGNhbiBnZXQgdGhpcyB2YWx1ZSBoZXJlXG4gICAgICAgICAgIC0gQnkgY2FuY2VsbGluZyB0aGUgcGFyZW50IHRhc2sgbWFudWFsbHlcbiAgICAgICAgICAtIEJ5IGpvaW5pbmcgYSBDYW5jZWxsZWQgdGFza1xuICAgICAgICAqKi9cbiAgICAgICAgbWFpblRhc2suc3RhdHVzID0gQ0FOQ0VMTEVEO1xuICAgICAgICAvKipcbiAgICAgICAgICBDYW5jZWxzIHRoZSBjdXJyZW50IGVmZmVjdDsgdGhpcyB3aWxsIHByb3BhZ2F0ZSB0aGUgY2FuY2VsbGF0aW9uIGRvd24gdG8gYW55IGNhbGxlZCB0YXNrc1xuICAgICAgICAqKi9cblxuICAgICAgICBuZXh0LmNhbmNlbCgpO1xuICAgICAgICAvKipcbiAgICAgICAgICBJZiB0aGlzIEdlbmVyYXRvciBoYXMgYSBgcmV0dXJuYCBtZXRob2QgdGhlbiBpbnZva2VzIGl0XG4gICAgICAgICAgVGhpcyB3aWxsIGp1bXAgdG8gdGhlIGZpbmFsbHkgYmxvY2tcbiAgICAgICAgKiovXG5cbiAgICAgICAgcmVzdWx0ID0gZnVuYyhpdGVyYXRvciQxLnJldHVybikgPyBpdGVyYXRvciQxLnJldHVybihUQVNLX0NBTkNFTCkgOiB7XG4gICAgICAgICAgZG9uZTogdHJ1ZSxcbiAgICAgICAgICB2YWx1ZTogVEFTS19DQU5DRUxcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSBpZiAoc2hvdWxkVGVybWluYXRlKGFyZykpIHtcbiAgICAgICAgLy8gV2UgZ2V0IFRFUk1JTkFURSBmbGFnLCBpLmUuIGJ5IHRha2luZyBmcm9tIGEgY2hhbm5lbCB0aGF0IGVuZGVkIHVzaW5nIGB0YWtlYCAoYW5kIG5vdCBgdGFrZW1gIHVzZWQgdG8gdHJhcCBFbmQgb2YgY2hhbm5lbHMpXG4gICAgICAgIHJlc3VsdCA9IGZ1bmMoaXRlcmF0b3IkMS5yZXR1cm4pID8gaXRlcmF0b3IkMS5yZXR1cm4oKSA6IHtcbiAgICAgICAgICBkb25lOiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBpdGVyYXRvciQxLm5leHQoYXJnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXN1bHQuZG9uZSkge1xuICAgICAgICBkaWdlc3RFZmZlY3QocmVzdWx0LnZhbHVlLCBwYXJlbnRFZmZlY3RJZCwgbmV4dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvKipcbiAgICAgICAgICBUaGlzIEdlbmVyYXRvciBoYXMgZW5kZWQsIHRlcm1pbmF0ZSB0aGUgbWFpbiB0YXNrIGFuZCBub3RpZnkgdGhlIGZvcmsgcXVldWVcbiAgICAgICAgKiovXG4gICAgICAgIGlmIChtYWluVGFzay5zdGF0dXMgIT09IENBTkNFTExFRCkge1xuICAgICAgICAgIG1haW5UYXNrLnN0YXR1cyA9IERPTkU7XG4gICAgICAgIH1cblxuICAgICAgICBtYWluVGFzay5jb250KHJlc3VsdC52YWx1ZSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChtYWluVGFzay5zdGF0dXMgPT09IENBTkNFTExFRCkge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cblxuICAgICAgbWFpblRhc2suc3RhdHVzID0gQUJPUlRFRDtcbiAgICAgIG1haW5UYXNrLmNvbnQoZXJyb3IsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJ1bkVmZmVjdChlZmZlY3QsIGVmZmVjdElkLCBjdXJyQ2IpIHtcbiAgICAvKipcbiAgICAgIGVhY2ggZWZmZWN0IHJ1bm5lciBtdXN0IGF0dGFjaCBpdHMgb3duIGxvZ2ljIG9mIGNhbmNlbGxhdGlvbiB0byB0aGUgcHJvdmlkZWQgY2FsbGJhY2tcbiAgICAgIGl0IGFsbG93cyB0aGlzIGdlbmVyYXRvciB0byBwcm9wYWdhdGUgY2FuY2VsbGF0aW9uIGRvd253YXJkLlxuICAgICAgIEFUVEVOVElPTiEgZWZmZWN0IHJ1bm5lcnMgbXVzdCBzZXR1cCB0aGUgY2FuY2VsIGxvZ2ljIGJ5IHNldHRpbmcgY2IuY2FuY2VsID0gW2NhbmNlbE1ldGhvZF1cbiAgICAgIEFuZCB0aGUgc2V0dXAgbXVzdCBvY2N1ciBiZWZvcmUgY2FsbGluZyB0aGUgY2FsbGJhY2tcbiAgICAgICBUaGlzIGlzIGEgc29ydCBvZiBpbnZlcnNpb24gb2YgY29udHJvbDogY2FsbGVkIGFzeW5jIGZ1bmN0aW9ucyBhcmUgcmVzcG9uc2libGVcbiAgICAgIG9mIGNvbXBsZXRpbmcgdGhlIGZsb3cgYnkgY2FsbGluZyB0aGUgcHJvdmlkZWQgY29udGludWF0aW9uOyB3aGlsZSBjYWxsZXIgZnVuY3Rpb25zXG4gICAgICBhcmUgcmVzcG9uc2libGUgZm9yIGFib3J0aW5nIHRoZSBjdXJyZW50IGZsb3cgYnkgY2FsbGluZyB0aGUgYXR0YWNoZWQgY2FuY2VsIGZ1bmN0aW9uXG4gICAgICAgTGlicmFyeSB1c2VycyBjYW4gYXR0YWNoIHRoZWlyIG93biBjYW5jZWxsYXRpb24gbG9naWMgdG8gcHJvbWlzZXMgYnkgZGVmaW5pbmcgYVxuICAgICAgcHJvbWlzZVtDQU5DRUxdIG1ldGhvZCBpbiB0aGVpciByZXR1cm5lZCBwcm9taXNlc1xuICAgICAgQVRURU5USU9OISBjYWxsaW5nIGNhbmNlbCBtdXN0IGhhdmUgbm8gZWZmZWN0IG9uIGFuIGFscmVhZHkgY29tcGxldGVkIG9yIGNhbmNlbGxlZCBlZmZlY3RcbiAgICAqKi9cbiAgICBpZiAocHJvbWlzZShlZmZlY3QpKSB7XG4gICAgICByZXNvbHZlUHJvbWlzZShlZmZlY3QsIGN1cnJDYik7XG4gICAgfSBlbHNlIGlmIChpdGVyYXRvcihlZmZlY3QpKSB7XG4gICAgICAvLyByZXNvbHZlIGl0ZXJhdG9yXG4gICAgICBwcm9jKGVudiwgZWZmZWN0LCB0YXNrLmNvbnRleHQsIGVmZmVjdElkLCBtZXRhLFxuICAgICAgLyogaXNSb290ICovXG4gICAgICBmYWxzZSwgY3VyckNiKTtcbiAgICB9IGVsc2UgaWYgKGVmZmVjdCAmJiBlZmZlY3RbSU9dKSB7XG4gICAgICB2YXIgZWZmZWN0UnVubmVyID0gZWZmZWN0UnVubmVyTWFwW2VmZmVjdC50eXBlXTtcbiAgICAgIGVmZmVjdFJ1bm5lcihlbnYsIGVmZmVjdC5wYXlsb2FkLCBjdXJyQ2IsIGV4ZWN1dGluZ0NvbnRleHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBhbnl0aGluZyBlbHNlIHJldHVybmVkIGFzIGlzXG4gICAgICBjdXJyQ2IoZWZmZWN0KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkaWdlc3RFZmZlY3QoZWZmZWN0LCBwYXJlbnRFZmZlY3RJZCwgY2IsIGxhYmVsKSB7XG4gICAgaWYgKGxhYmVsID09PSB2b2lkIDApIHtcbiAgICAgIGxhYmVsID0gJyc7XG4gICAgfVxuXG4gICAgdmFyIGVmZmVjdElkID0gbmV4dFNhZ2FJZCgpO1xuICAgIGVudi5zYWdhTW9uaXRvciAmJiBlbnYuc2FnYU1vbml0b3IuZWZmZWN0VHJpZ2dlcmVkKHtcbiAgICAgIGVmZmVjdElkOiBlZmZlY3RJZCxcbiAgICAgIHBhcmVudEVmZmVjdElkOiBwYXJlbnRFZmZlY3RJZCxcbiAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgIGVmZmVjdDogZWZmZWN0XG4gICAgfSk7XG4gICAgLyoqXG4gICAgICBjb21wbGV0aW9uIGNhbGxiYWNrIGFuZCBjYW5jZWwgY2FsbGJhY2sgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZVxuICAgICAgV2UgY2FuJ3QgY2FuY2VsIGFuIGFscmVhZHkgY29tcGxldGVkIGVmZmVjdFxuICAgICAgQW5kIFdlIGNhbid0IGNvbXBsZXRlIGFuIGFscmVhZHkgY2FuY2VsbGVkIGVmZmVjdElkXG4gICAgKiovXG5cbiAgICB2YXIgZWZmZWN0U2V0dGxlZDsgLy8gQ29tcGxldGlvbiBjYWxsYmFjayBwYXNzZWQgdG8gdGhlIGFwcHJvcHJpYXRlIGVmZmVjdCBydW5uZXJcblxuICAgIGZ1bmN0aW9uIGN1cnJDYihyZXMsIGlzRXJyKSB7XG4gICAgICBpZiAoZWZmZWN0U2V0dGxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGVmZmVjdFNldHRsZWQgPSB0cnVlO1xuICAgICAgY2IuY2FuY2VsID0gbm9vcDsgLy8gZGVmZW5zaXZlIG1lYXN1cmVcblxuICAgICAgaWYgKGVudi5zYWdhTW9uaXRvcikge1xuICAgICAgICBpZiAoaXNFcnIpIHtcbiAgICAgICAgICBlbnYuc2FnYU1vbml0b3IuZWZmZWN0UmVqZWN0ZWQoZWZmZWN0SWQsIHJlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZW52LnNhZ2FNb25pdG9yLmVmZmVjdFJlc29sdmVkKGVmZmVjdElkLCByZXMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0Vycikge1xuICAgICAgICBzZXRDcmFzaGVkRWZmZWN0KGVmZmVjdCk7XG4gICAgICB9XG5cbiAgICAgIGNiKHJlcywgaXNFcnIpO1xuICAgIH0gLy8gdHJhY2tzIGRvd24gdGhlIGN1cnJlbnQgY2FuY2VsXG5cblxuICAgIGN1cnJDYi5jYW5jZWwgPSBub29wOyAvLyBzZXR1cCBjYW5jZWxsYXRpb24gbG9naWMgb24gdGhlIHBhcmVudCBjYlxuXG4gICAgY2IuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgLy8gcHJldmVudHMgY2FuY2VsbGluZyBhbiBhbHJlYWR5IGNvbXBsZXRlZCBlZmZlY3RcbiAgICAgIGlmIChlZmZlY3RTZXR0bGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZWZmZWN0U2V0dGxlZCA9IHRydWU7XG4gICAgICBjdXJyQ2IuY2FuY2VsKCk7IC8vIHByb3BhZ2F0ZXMgY2FuY2VsIGRvd253YXJkXG5cbiAgICAgIGN1cnJDYi5jYW5jZWwgPSBub29wOyAvLyBkZWZlbnNpdmUgbWVhc3VyZVxuXG4gICAgICBlbnYuc2FnYU1vbml0b3IgJiYgZW52LnNhZ2FNb25pdG9yLmVmZmVjdENhbmNlbGxlZChlZmZlY3RJZCk7XG4gICAgfTtcblxuICAgIGZpbmFsUnVuRWZmZWN0KGVmZmVjdCwgZWZmZWN0SWQsIGN1cnJDYik7XG4gIH1cbn1cblxudmFyIFJVTl9TQUdBX1NJR05BVFVSRSA9ICdydW5TYWdhKG9wdGlvbnMsIHNhZ2EsIC4uLmFyZ3MpJztcbnZhciBOT05fR0VORVJBVE9SX0VSUiA9IFJVTl9TQUdBX1NJR05BVFVSRSArIFwiOiBzYWdhIGFyZ3VtZW50IG11c3QgYmUgYSBHZW5lcmF0b3IgZnVuY3Rpb24hXCI7XG5mdW5jdGlvbiBydW5TYWdhKF9yZWYsIHNhZ2EpIHtcbiAgdmFyIF9yZWYkY2hhbm5lbCA9IF9yZWYuY2hhbm5lbCxcbiAgICAgIGNoYW5uZWwgPSBfcmVmJGNoYW5uZWwgPT09IHZvaWQgMCA/IHN0ZENoYW5uZWwoKSA6IF9yZWYkY2hhbm5lbCxcbiAgICAgIGRpc3BhdGNoID0gX3JlZi5kaXNwYXRjaCxcbiAgICAgIGdldFN0YXRlID0gX3JlZi5nZXRTdGF0ZSxcbiAgICAgIF9yZWYkY29udGV4dCA9IF9yZWYuY29udGV4dCxcbiAgICAgIGNvbnRleHQgPSBfcmVmJGNvbnRleHQgPT09IHZvaWQgMCA/IHt9IDogX3JlZiRjb250ZXh0LFxuICAgICAgc2FnYU1vbml0b3IgPSBfcmVmLnNhZ2FNb25pdG9yLFxuICAgICAgZWZmZWN0TWlkZGxld2FyZXMgPSBfcmVmLmVmZmVjdE1pZGRsZXdhcmVzLFxuICAgICAgX3JlZiRvbkVycm9yID0gX3JlZi5vbkVycm9yLFxuICAgICAgb25FcnJvciA9IF9yZWYkb25FcnJvciA9PT0gdm9pZCAwID8gbG9nRXJyb3IgOiBfcmVmJG9uRXJyb3I7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBjaGVjayhzYWdhLCBmdW5jLCBOT05fR0VORVJBVE9SX0VSUik7XG4gIH1cblxuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMiA/IF9sZW4gLSAyIDogMCksIF9rZXkgPSAyOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgYXJnc1tfa2V5IC0gMl0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICB2YXIgaXRlcmF0b3IkMSA9IHNhZ2EuYXBwbHkodm9pZCAwLCBhcmdzKTtcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgIGNoZWNrKGl0ZXJhdG9yJDEsIGl0ZXJhdG9yLCBOT05fR0VORVJBVE9SX0VSUik7XG4gIH1cblxuICB2YXIgZWZmZWN0SWQgPSBuZXh0U2FnYUlkKCk7XG5cbiAgaWYgKHNhZ2FNb25pdG9yKSB7XG4gICAgLy8gbW9uaXRvcnMgYXJlIGV4cGVjdGVkIHRvIGhhdmUgYSBjZXJ0YWluIGludGVyZmFjZSwgbGV0J3MgZmlsbC1pbiBhbnkgbWlzc2luZyBvbmVzXG4gICAgc2FnYU1vbml0b3Iucm9vdFNhZ2FTdGFydGVkID0gc2FnYU1vbml0b3Iucm9vdFNhZ2FTdGFydGVkIHx8IG5vb3A7XG4gICAgc2FnYU1vbml0b3IuZWZmZWN0VHJpZ2dlcmVkID0gc2FnYU1vbml0b3IuZWZmZWN0VHJpZ2dlcmVkIHx8IG5vb3A7XG4gICAgc2FnYU1vbml0b3IuZWZmZWN0UmVzb2x2ZWQgPSBzYWdhTW9uaXRvci5lZmZlY3RSZXNvbHZlZCB8fCBub29wO1xuICAgIHNhZ2FNb25pdG9yLmVmZmVjdFJlamVjdGVkID0gc2FnYU1vbml0b3IuZWZmZWN0UmVqZWN0ZWQgfHwgbm9vcDtcbiAgICBzYWdhTW9uaXRvci5lZmZlY3RDYW5jZWxsZWQgPSBzYWdhTW9uaXRvci5lZmZlY3RDYW5jZWxsZWQgfHwgbm9vcDtcbiAgICBzYWdhTW9uaXRvci5hY3Rpb25EaXNwYXRjaGVkID0gc2FnYU1vbml0b3IuYWN0aW9uRGlzcGF0Y2hlZCB8fCBub29wO1xuICAgIHNhZ2FNb25pdG9yLnJvb3RTYWdhU3RhcnRlZCh7XG4gICAgICBlZmZlY3RJZDogZWZmZWN0SWQsXG4gICAgICBzYWdhOiBzYWdhLFxuICAgICAgYXJnczogYXJnc1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBpZiAobm90VW5kZWYoZGlzcGF0Y2gpKSB7XG4gICAgICBjaGVjayhkaXNwYXRjaCwgZnVuYywgJ2Rpc3BhdGNoIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cblxuICAgIGlmIChub3RVbmRlZihnZXRTdGF0ZSkpIHtcbiAgICAgIGNoZWNrKGdldFN0YXRlLCBmdW5jLCAnZ2V0U3RhdGUgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuXG4gICAgaWYgKG5vdFVuZGVmKGVmZmVjdE1pZGRsZXdhcmVzKSkge1xuICAgICAgdmFyIE1JRERMRVdBUkVfVFlQRV9FUlJPUiA9ICdlZmZlY3RNaWRkbGV3YXJlcyBtdXN0IGJlIGFuIGFycmF5IG9mIGZ1bmN0aW9ucyc7XG4gICAgICBjaGVjayhlZmZlY3RNaWRkbGV3YXJlcywgYXJyYXkkMSwgTUlERExFV0FSRV9UWVBFX0VSUk9SKTtcbiAgICAgIGVmZmVjdE1pZGRsZXdhcmVzLmZvckVhY2goZnVuY3Rpb24gKGVmZmVjdE1pZGRsZXdhcmUpIHtcbiAgICAgICAgcmV0dXJuIGNoZWNrKGVmZmVjdE1pZGRsZXdhcmUsIGZ1bmMsIE1JRERMRVdBUkVfVFlQRV9FUlJPUik7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjaGVjayhvbkVycm9yLCBmdW5jLCAnb25FcnJvciBwYXNzZWQgdG8gdGhlIHJlZHV4LXNhZ2EgaXMgbm90IGEgZnVuY3Rpb24hJyk7XG4gIH1cblxuICB2YXIgZmluYWxpemVSdW5FZmZlY3Q7XG5cbiAgaWYgKGVmZmVjdE1pZGRsZXdhcmVzKSB7XG4gICAgdmFyIG1pZGRsZXdhcmUgPSBjb21wb3NlLmFwcGx5KHZvaWQgMCwgZWZmZWN0TWlkZGxld2FyZXMpO1xuXG4gICAgZmluYWxpemVSdW5FZmZlY3QgPSBmdW5jdGlvbiBmaW5hbGl6ZVJ1bkVmZmVjdChydW5FZmZlY3QpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoZWZmZWN0LCBlZmZlY3RJZCwgY3VyckNiKSB7XG4gICAgICAgIHZhciBwbGFpblJ1bkVmZmVjdCA9IGZ1bmN0aW9uIHBsYWluUnVuRWZmZWN0KGVmZikge1xuICAgICAgICAgIHJldHVybiBydW5FZmZlY3QoZWZmLCBlZmZlY3RJZCwgY3VyckNiKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbWlkZGxld2FyZShwbGFpblJ1bkVmZmVjdCkoZWZmZWN0KTtcbiAgICAgIH07XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBmaW5hbGl6ZVJ1bkVmZmVjdCA9IGlkZW50aXR5O1xuICB9XG5cbiAgdmFyIGVudiA9IHtcbiAgICBjaGFubmVsOiBjaGFubmVsLFxuICAgIGRpc3BhdGNoOiB3cmFwU2FnYURpc3BhdGNoKGRpc3BhdGNoKSxcbiAgICBnZXRTdGF0ZTogZ2V0U3RhdGUsXG4gICAgc2FnYU1vbml0b3I6IHNhZ2FNb25pdG9yLFxuICAgIG9uRXJyb3I6IG9uRXJyb3IsXG4gICAgZmluYWxpemVSdW5FZmZlY3Q6IGZpbmFsaXplUnVuRWZmZWN0XG4gIH07XG4gIHJldHVybiBpbW1lZGlhdGVseShmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRhc2sgPSBwcm9jKGVudiwgaXRlcmF0b3IkMSwgY29udGV4dCwgZWZmZWN0SWQsIGdldE1ldGFJbmZvKHNhZ2EpLFxuICAgIC8qIGlzUm9vdCAqL1xuICAgIHRydWUsIHVuZGVmaW5lZCk7XG5cbiAgICBpZiAoc2FnYU1vbml0b3IpIHtcbiAgICAgIHNhZ2FNb25pdG9yLmVmZmVjdFJlc29sdmVkKGVmZmVjdElkLCB0YXNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGFzaztcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNhZ2FNaWRkbGV3YXJlRmFjdG9yeShfdGVtcCkge1xuICB2YXIgX3JlZiA9IF90ZW1wID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wLFxuICAgICAgX3JlZiRjb250ZXh0ID0gX3JlZi5jb250ZXh0LFxuICAgICAgY29udGV4dCA9IF9yZWYkY29udGV4dCA9PT0gdm9pZCAwID8ge30gOiBfcmVmJGNvbnRleHQsXG4gICAgICBfcmVmJGNoYW5uZWwgPSBfcmVmLmNoYW5uZWwsXG4gICAgICBjaGFubmVsID0gX3JlZiRjaGFubmVsID09PSB2b2lkIDAgPyBzdGRDaGFubmVsKCkgOiBfcmVmJGNoYW5uZWwsXG4gICAgICBzYWdhTW9uaXRvciA9IF9yZWYuc2FnYU1vbml0b3IsXG4gICAgICBvcHRpb25zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZiwgW1wiY29udGV4dFwiLCBcImNoYW5uZWxcIiwgXCJzYWdhTW9uaXRvclwiXSk7XG5cbiAgdmFyIGJvdW5kUnVuU2FnYTtcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgIGNoZWNrKGNoYW5uZWwsIGNoYW5uZWwkMSwgJ29wdGlvbnMuY2hhbm5lbCBwYXNzZWQgdG8gdGhlIFNhZ2EgbWlkZGxld2FyZSBpcyBub3QgYSBjaGFubmVsJyk7XG4gIH1cblxuICBmdW5jdGlvbiBzYWdhTWlkZGxld2FyZShfcmVmMikge1xuICAgIHZhciBnZXRTdGF0ZSA9IF9yZWYyLmdldFN0YXRlLFxuICAgICAgICBkaXNwYXRjaCA9IF9yZWYyLmRpc3BhdGNoO1xuICAgIGJvdW5kUnVuU2FnYSA9IHJ1blNhZ2EuYmluZChudWxsLCBfZXh0ZW5kcyh7fSwgb3B0aW9ucywge1xuICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgIGNoYW5uZWw6IGNoYW5uZWwsXG4gICAgICBkaXNwYXRjaDogZGlzcGF0Y2gsXG4gICAgICBnZXRTdGF0ZTogZ2V0U3RhdGUsXG4gICAgICBzYWdhTW9uaXRvcjogc2FnYU1vbml0b3JcbiAgICB9KSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICBpZiAoc2FnYU1vbml0b3IgJiYgc2FnYU1vbml0b3IuYWN0aW9uRGlzcGF0Y2hlZCkge1xuICAgICAgICAgIHNhZ2FNb25pdG9yLmFjdGlvbkRpc3BhdGNoZWQoYWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciByZXN1bHQgPSBuZXh0KGFjdGlvbik7IC8vIGhpdCByZWR1Y2Vyc1xuXG4gICAgICAgIGNoYW5uZWwucHV0KGFjdGlvbik7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9O1xuICAgIH07XG4gIH1cblxuICBzYWdhTWlkZGxld2FyZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWJvdW5kUnVuU2FnYSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdCZWZvcmUgcnVubmluZyBhIFNhZ2EsIHlvdSBtdXN0IG1vdW50IHRoZSBTYWdhIG1pZGRsZXdhcmUgb24gdGhlIFN0b3JlIHVzaW5nIGFwcGx5TWlkZGxld2FyZScpO1xuICAgIH1cblxuICAgIHJldHVybiBib3VuZFJ1blNhZ2EuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHNhZ2FNaWRkbGV3YXJlLnNldENvbnRleHQgPSBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgY2hlY2socHJvcHMsIG9iamVjdCwgY3JlYXRlU2V0Q29udGV4dFdhcm5pbmcoJ3NhZ2FNaWRkbGV3YXJlJywgcHJvcHMpKTtcbiAgICB9XG5cbiAgICBhc3NpZ25XaXRoU3ltYm9scyhjb250ZXh0LCBwcm9wcyk7XG4gIH07XG5cbiAgcmV0dXJuIHNhZ2FNaWRkbGV3YXJlO1xufVxuXG5leHBvcnQgZGVmYXVsdCBzYWdhTWlkZGxld2FyZUZhY3Rvcnk7XG5leHBvcnQgeyBFTkQsIGNoYW5uZWwsIGV2ZW50Q2hhbm5lbCwgaXNFbmQsIG11bHRpY2FzdENoYW5uZWwsIHJ1blNhZ2EsIHN0ZENoYW5uZWwgfTtcbiIsImltcG9ydCBjcmVhdGVTYWdhTWlkZGxld2FyZV9fZGVmYXVsdCBmcm9tICdAcmVkdXgtc2FnYS9jb3JlJztcbmV4cG9ydCAqIGZyb20gJ0ByZWR1eC1zYWdhL2NvcmUnO1xuXG5cblxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlU2FnYU1pZGRsZXdhcmVfX2RlZmF1bHQ7XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7XG4gIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgdmFyIGtleSwgaTtcbiAgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHtcbiAgICBrZXkgPSBzb3VyY2VLZXlzW2ldO1xuICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufSJdLCJuYW1lcyI6WyJkZWYiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJxdWV1ZSIsInNlbWFwaG9yZSIsImV4ZWMiLCJ0YXNrIiwic3VzcGVuZCIsInJlbGVhc2UiLCJhc2FwIiwicHVzaCIsImZsdXNoIiwiaW1tZWRpYXRlbHkiLCJ1bmRlZmluZWQiLCJzaGlmdCIsImFycmF5IiwicGF0dGVybnMiLCJpbnB1dCIsInNvbWUiLCJwIiwibWF0Y2hlciIsInByZWRpY2F0ZSIsIl9wcmVkaWNhdGUiLCJzdHJpbmciLCJwYXR0ZXJuIiwidHlwZSIsIlN0cmluZyIsInN5bWJvbCIsIndpbGRjYXJkIiwiayIsIm1hdGNoZXJDcmVhdG9yIiwiRXJyb3IiLCJFTkQiLCJpc0VuZCIsImEiLCJjaGFubmVsIiwiYnVmZmVyJDEiLCJlIiwiY2xvc2VkIiwidGFrZXJzIiwidGFrZSIsImNiIiwiaXNFbXB0eSIsImNhbmNlbCIsInIiLCJwdXQiLCJsZW5ndGgiLCJjbG9zZSIsImFyciIsImkiLCJsZW4iLCJ0YWtlciIsImV2ZW50Q2hhbm5lbCIsInN1YnNjcmliZSIsImJ1ZmZlciIsIm4iLCJ1bnN1YnNjcmliZSIsImNoYW4iLCJvIiwibXVsdGljYXN0Q2hhbm5lbCIsIl9yZWYiLCJjdXJyZW50VGFrZXJzIiwibmV4dFRha2VycyIsImVuc3VyZUNhbk11dGF0ZU5leHRUYWtlcnMiLCJzbGljZSIsImZvckVhY2giLCJzdGRDaGFubmVsIiwiUlVOTklORyIsIkNBTkNFTExFRCIsIkFCT1JURUQiLCJET05FIiwicmVzb2x2ZVByb21pc2UiLCJjYW5jZWxQcm9taXNlIiwidGhlbiIsImVycm9yIiwiX2VmZmVjdFJ1bm5lck1hcCIsImN1cnJlbnQiLCJuZXh0U2FnYUlkIiwiY2FuY2VsU2luZ2xlVGFzayIsInRhc2tUb0NhbmNlbCIsImlzUnVubmluZyIsImVmZmVjdFJ1bm5lck1hcCIsIlQiLCJlbnYiLCJfcmVmMyIsIl9yZWYzJGNoYW5uZWwiLCJtYXliZSIsInRha2VDYiIsImVyciIsIlAiLCJfcmVmMiIsImFjdGlvbiIsInJlc3VsdCIsImRpc3BhdGNoIiwiQSIsImVmZmVjdHMiLCJfcmVmMTEiLCJkaWdlc3RFZmZlY3QiLCJlZmZlY3RJZCIsImtleXMiLCJPYmplY3QiLCJjaGlsZENhbGxiYWNrcyIsImtleSIsIlIiLCJfcmVmMTIiLCJyZXNwb25zZSIsImNoaWxkQ2JzIiwiY29tcGxldGVkIiwiY2hDYkF0S2V5IiwicmVzIiwiaXNFcnIiLCJzIiwiQyIsIl9yZWY0IiwiX3JlZjUiLCJjb250ZXh0IiwiZm4iLCJhcmdzIiwiYXBwbHkiLCJwcm9jIiwiX3JlZjYiLCJjcHNDYiIsImNvbmNhdCIsIkYiLCJfcmVmNyIsIl9yZWY4IiwiZGV0YWNoZWQiLCJwYXJlbnQiLCJ0YXNrSXRlcmF0b3IiLCJyZXNvbHZlZCIsImFyZyIsInZhbHVlIiwiZG9uZSIsImNyZWF0ZVRhc2tJdGVyYXRvciIsIm1ldGEiLCJpdGVyYXRvciIsImlzU2FnYUl0ZXJhdG9yIiwibmFtZSIsImdldEl0ZXJhdG9yTWV0YUluZm8iLCJjaGlsZCIsImFkZFRhc2siLCJpc0Fib3J0ZWQiLCJhYm9ydCIsIkoiLCJ0YXNrT3JUYXNrcyIsIl9yZWY5Iiwiam9pblNpbmdsZVRhc2siLCJ0YXNrVG9Kb2luIiwiam9pbmVyIiwiam9pbmVycyIsInQiLCJfcmVmMTAiLCJTIiwiX3JlZjEzIiwic2VsZWN0b3IiLCJnZXRTdGF0ZSIsIl9yZWYxNCIsIm1hdGNoIiwiZGF0YSIsIl9yZWYxNSIsImlzQ2FuY2VsbGVkIiwiRyIsInByb3AiLCJfcmVmMTYiLCJwcm9wcyIsIl9yZWYxNyIsImZvcm1hdExvY2F0aW9uIiwiZmlsZU5hbWUiLCJsaW5lTnVtYmVyIiwic2FnYUxvY2F0aW9uQXNTdHJpbmciLCJzYWdhTWV0YSIsImxvY2F0aW9uIiwiY2FuY2VsbGVkVGFza3NBc1N0cmluZyIsInNhZ2FTdGFjayIsImNhbmNlbGxlZFRhc2tzIiwiam9pbiIsImNyYXNoZWRFZmZlY3QiLCJhZGRTYWdhRnJhbWUiLCJmcmFtZSIsImNsZWFyIiwic2V0Q3Jhc2hlZEVmZmVjdCIsImVmZmVjdCIsImZpcnN0U2FnYSIsIm90aGVyU2FnYXMiLCJjcmFzaGVkRWZmZWN0TG9jYXRpb24iLCJjb2RlIiwibWFwIiwiaXRlcmF0b3IkMSIsInBhcmVudENvbnRleHQiLCJwYXJlbnRFZmZlY3RJZCIsImlzUm9vdCIsImNvbnQiLCJmaW5hbFJ1bkVmZmVjdCIsImZpbmFsaXplUnVuRWZmZWN0IiwiY3VyckNiIiwiSU8iLCJlZmZlY3RSdW5uZXIiLCJwYXlsb2FkIiwiZXhlY3V0aW5nQ29udGV4dCIsIm5leHQiLCJtYWluVGFzayIsInN0YXR1cyIsIl90YXNrIiwidGFza1Jlc3VsdCIsInRhc2tFcnJvciIsImRlZmVycmVkRW5kIiwiY2FuY2VsbGVkRHVlVG9FcnJvclRhc2tzIiwiY3JlYXRlIiwib25BYm9ydCIsInRhc2tzIiwiY2FuY2VsQWxsIiwiZ2V0VGFza3MiLCJmb3JrUXVldWUiLCJlbmQiLCJvbkVycm9yIiwiaWQiLCJzZXRDb250ZXh0IiwidG9Qcm9taXNlIiwibmV3VGFzayIsInRocm93IiwicmV0dXJuIiwibGFiZWwiLCJlZmZlY3RTZXR0bGVkIiwic2FnYU1vbml0b3IiLCJlZmZlY3RSZWplY3RlZCIsImVmZmVjdFJlc29sdmVkIiwiZWZmZWN0VHJpZ2dlcmVkIiwiZWZmZWN0Q2FuY2VsbGVkIiwicnVuU2FnYSIsInNhZ2EiLCJfcmVmJGNoYW5uZWwiLCJfcmVmJGNvbnRleHQiLCJlZmZlY3RNaWRkbGV3YXJlcyIsIl9yZWYkb25FcnJvciIsIl9sZW4iLCJhcmd1bWVudHMiLCJBcnJheSIsIl9rZXkiLCJyb290U2FnYVN0YXJ0ZWQiLCJhY3Rpb25EaXNwYXRjaGVkIiwibWlkZGxld2FyZSIsInJ1bkVmZmVjdCIsImVmZiIsIl90ZW1wIiwiYm91bmRSdW5TYWdhIiwib3B0aW9ucyIsInNhZ2FNaWRkbGV3YXJlIiwiYmluZCIsInJ1biIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlIiwic291cmNlIiwiZXhjbHVkZWQiLCJ0YXJnZXQiLCJzb3VyY2VLZXlzIiwiaW5kZXhPZiJdLCJzb3VyY2VSb290IjoiIn0=